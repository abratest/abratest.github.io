(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{503:function(e,t,r){"use strict";r.d(t,"c",(function(){return y})),r.d(t,"a",(function(){return N})),r.d(t,"b",(function(){return _}));var n=r(108),o=r(94),h=r(79),c=r(109),d=r(817),l=r(501),k=r(639),f=r(1390);class m extends o.AuthorizationError{constructor(){super({error:"The popup was dismissed."})}}class T extends o.AuthorizationError{constructor(){super({error:"The popup was blocked."})}}class w extends o.AuthorizationRequestHandler{constructor(e=new o.BasicQueryStringUtils,t=new o.DefaultCrypto){super(e,t),this.popupWindow=null,this.isCancelled=!1,this.isBlocked=!1,this.validator=new f.a(()=>{this.isBlocked=!0,this.completeAuthorizationRequestIfPossible()})}performAuthorizationRequest(e,t){const r=this.buildRequestUrl(e,t);this.pendingRequest=t,this.id=t.state,window["popupCallback_"+t.state]=this.callback.bind(this),this.closedTimer=window.setInterval(this.checkPopup.bind(this),h.g);const n=function(){const e=h.k,t=e.width,r=e.height,n=window.screenLeft||window.screenX,o=window.screenTop||window.screenY,c=(window.innerWidth||document.documentElement.clientWidth||screen.width)/2-t/2,d=(window.innerHeight||document.documentElement.clientHeight||screen.height)/2-r/2;return e.left=c+n,e.top=d+o,e}();var o;this.popupWindow=window.open(r,"_blank",(o=n,Object.keys(o).reduce((e,t)=>{const r=o[t];return e.push(`${t}=${r}`),e},Array()).join(",")+";")),this.validator.check(this.popupWindow),this.popupWindow&&this.popupWindow.focus()}callback(e){this.responseUrl=e,this.completeAuthorizationRequestIfPossible()}completeAuthorizationRequestIfPossible(){return this.completeAuthorizationRequest().then(e=>{e&&this.notifier&&this.notifier.onAuthorizationComplete(e.request,e.response,e.error)})}completeAuthorizationRequest(){const e=this.pendingRequest;if(!e)return Promise.resolve(null);if(!0===this.isCancelled)return this.respondWithCancelled(e);if(!0===this.isBlocked)return this.respondWithBlocked(e);if(this.error)return this.respondWithError(e,this.error.message);if(!this.responseUrl)return Promise.resolve(null);const data=Object(k.a)(this.responseUrl),t=data.state;if(e.state!==t)return Promise.resolve(null);const r=data.error;if(r){const t=data.error_uri,n=data.error_description;return this.respondWithError(e,r,n,t)}const code=data.code;return this.respondWithCode(e,code)}respondWithBlocked(e){const t={request:e,error:new T,response:null};return this.cleanup(),Promise.resolve(t)}respondWithCancelled(e){const t={request:e,error:new m,response:null};return this.cleanup(),Promise.resolve(t)}respondWithError(e,t,r,n){const h={request:e,error:new o.AuthorizationError({error:t,error_description:r,error_uri:n,state:e.state}),response:null};return this.cleanup(),Promise.resolve(h)}respondWithCode(e,code){let t=null;code&&(t=new o.AuthorizationResponse({code:code,state:e.state}));const r={request:e,response:t,error:null};return this.cleanup(),Promise.resolve(r)}cleanup(){window.clearInterval(this.closedTimer),delete window["popupCallback_"+this.id],this.popupWindow&&this.popupWindow.close(),this.popupWindow=null,this.pendingRequest=void 0,this.error=void 0,this.id=void 0,this.responseUrl=void 0}checkPopup(){this.popupWindow&&this.popupWindow.closed&&(window.clearInterval(this.closedTimer),this.isCancelled=!0,this.completeAuthorizationRequestIfPossible())}}class v{constructor(e){this.clientId=e.clientId,this.redirectUri=e.redirectUri,this.configuration=e.configuration||new o.AuthorizationServiceConfiguration(h.i);const t=e.additionalScopes||h.j;this.scopes=h.l.concat(t),this.tokenHandler=new o.BaseTokenRequestHandler(new o.FetchRequestor),this.notifier=new o.AuthorizationNotifier,this.notifier.setAuthorizationListener(this.didCompleteAuthorizationFlow.bind(this))}signInPopup(e){e=e||{};const t=new Promise((e,t)=>{this.pendingResolver={fulfill:e,reject:t}});this.authHandler=new w,this.authHandler.setAuthorizationNotifier(this.notifier);const r=this.createAuthRequest(e);return this.authHandler.performAuthorizationRequest(this.configuration,r),t.then(e=>this.requestAccessToken(e.code))}signInRedirect(e){e=e||{};const t=new Promise((e,t)=>{this.pendingResolver={fulfill:e,reject:t}});this.authHandler=new o.RedirectRequestHandler(void 0,new d.a),this.authHandler.setAuthorizationNotifier(this.notifier);const r=this.createAuthRequest(e);return this.authHandler.performAuthorizationRequest(this.configuration,r),t}redirectCallback(){const e=new Promise((e,t)=>{this.pendingResolver={fulfill:e,reject:t}});return this.authHandler=new o.RedirectRequestHandler(void 0,new d.a),this.authHandler.setAuthorizationNotifier(this.notifier),this.authHandler.completeAuthorizationRequestIfPossible(),e.then(e=>this.requestAccessToken(e.code))}requestAccessToken(code){const e=this.createTokenRequest(code);return this.tokenHandler.performTokenRequest(this.configuration,e)}refreshAccessToken(e){const t=this.createRefreshTokenRequest(e);return this.tokenHandler.performTokenRequest(this.configuration,t)}requestSignOut(e){return fetch(h.d+"/logout",{headers:{Accept:"application/json",Authorization:"Bearer "+e,"Content-Type":"application/json"},method:"POST"}).then(e=>Object(l.a)(e))}requestUserInfo(e){const t=this.configuration.userInfoEndpoint;return t?fetch(t,{headers:{Accept:"application/json",Authorization:"Bearer "+e}}).then(e=>Object(l.a)(e)):Promise.reject(c.a.InvalidConfiguration("Could not find user info endpoint"))}didCompleteAuthorizationFlow(e,t,r){if(this.pendingResolver)if(t)this.pendingResolver.fulfill(t),this.pendingResolver=void 0;else if(r){if(r instanceof m)this.pendingResolver.reject(c.a.UserCancelled());else if(r instanceof T){const e=/^(http?s:\/\/[\w.]*)\/[\w/]*$/,t=this.configuration.authorizationEndpoint.match(e),r=t&&t.length>1?t[1]:"";this.pendingResolver.reject(c.a.PopupBlocked(r))}else this.pendingResolver.reject(c.a.ServerError(r.error,r.errorDescription));this.pendingResolver=void 0}}createAuthRequest(e){const t=new o.AuthorizationRequest({client_id:this.clientId,redirect_uri:this.redirectUri,response_type:o.AuthorizationRequest.RESPONSE_TYPE_CODE,scope:this.scopes.join(" ")},void 0,!1);return e.login_hint&&(t.extras={login_hint:e.login_hint}),t}createRefreshTokenRequest(e){return new o.TokenRequest({client_id:this.clientId,grant_type:o.GRANT_TYPE_REFRESH_TOKEN,redirect_uri:this.redirectUri,refresh_token:e})}createTokenRequest(code){return new o.TokenRequest({client_id:this.clientId,code:code,grant_type:o.GRANT_TYPE_AUTHORIZATION_CODE,redirect_uri:this.redirectUri})}}var S=r(413);class R{constructor(e,t,r){this.token=e,this.scope=r,this.expiresAt=t}static fromTokenResponse(e){let t;return e.expiresIn&&(t=Math.floor(Date.now()/1e3)+e.expiresIn),new R(e.accessToken,t,e.scope)}static fromString(s){let e;try{e=JSON.parse(s)}catch(e){return}if(e.token)return new R(e.token,e.expiresAt,e.scope)}get expired(){if(this.expiresAt){const e=Math.floor(Date.now()/1e3);return this.expiresAt-e<=0}return!1}toStorageString(){return JSON.stringify({expiresAt:this.expiresAt,scope:this.scope,token:this.token})}}class I{constructor(e,t){this.clientId=e,this.store=t||new S.a;const r=this.store.getItem(this.accessTokenKey);if(r){let e;try{e=R.fromString(r)}finally{this.accessToken=e}}this.idToken=this.store.getItem(this.idTokenKey)}get currentToken(){if(this.accessToken&&!this.accessToken.expired)return this.accessToken.token}get currentIdToken(){if(this.idToken&&this.accessToken&&!this.accessToken.expired)return this.idToken}get refreshToken(){const e=this.store.getItem(this.refreshTokenKey);if(e)return e}get idTokenKey(){return`${h.m}.${this.clientId}`}get accessTokenKey(){return`${h.a}.${this.clientId}`}get refreshTokenKey(){return`${h.o}.${this.clientId}`}persistTokenResponse(e){e.refreshToken&&this.store.setItem(this.refreshTokenKey,e.refreshToken);const t=R.fromTokenResponse(e);this.store.setItem(this.accessTokenKey,t.toStorageString()),this.store.setItem(this.idTokenKey,e.idToken),this.accessToken=t,this.idToken=e.idToken}invalidateCurrentToken(){this.accessToken=void 0,this.idToken=void 0,this.store.clearItem(this.accessTokenKey),this.store.clearItem(this.idTokenKey)}clear(){this.accessToken=void 0,this.idToken=void 0,this.store.clearItem(this.refreshTokenKey),this.store.clearItem(this.accessTokenKey),this.store.clearItem(this.idTokenKey)}}class P{constructor(e,t,r,n,o,h,c){this.id=e,this.accounts=t,this.email=r,this.emailVerified=n,this.phoneNumber=o,this.phoneNumberVerified=h,this.preferredUsername=c}static fromJson(e){return new P(e.sub,e.accounts,e.email,e.email_verified,e.phone_number,e.phone_number_verified,e.preferred_username)}static fromString(s){let e;try{e=JSON.parse(s)}catch(e){return}if(e.id)return new P(e.id,e.accounts,e.email,e.emailVerified,e.phoneNumber,e.phoneNumberVerified,e.preferredUsername)}toStorageString(){return JSON.stringify({accounts:this.accounts,email:this.email,emailVerified:this.emailVerified,id:this.id,phoneNumber:this.phoneNumber,phoneNumberVerified:this.phoneNumberVerified,preferredUsername:this.preferredUsername})}}class A{constructor(e,t){this.clientId=e,this.store=t||new S.a,this.user=this.fetchUser()}get currentUser(){return this.user||this.fetchUser()}get storageKey(){return`${h.q}.${this.clientId}`}set(e){this.user=e,this.cacheUser(e)}clear(){this.user=void 0,this.cacheUser(void 0)}fetchUser(){const e=this.store.getItem(this.storageKey);if(e)return P.fromString(e)}cacheUser(e){e?this.store.setItem(this.storageKey,e.toStorageString()):this.store.clearItem(this.storageKey)}}class C{constructor(e,t,r,n){n=n||{};const o={additionalScopes:r,clientId:e,redirectUri:t};Object.assign(o,n),this.oauthManager=new v(o),this.tokenStore=new I(e,n.store),this.userStore=new A(e,n.store)}get authStatus(){return this.tokenStore.currentToken?N.Connected:this.tokenStore.refreshToken?N.Expired:N.NotConnected}getAccessToken(){return this.tokenStore.currentToken?Promise.resolve(this.tokenStore.currentToken):this.tokenStore.refreshToken?this.refreshAccessToken():Promise.reject(c.a.NotSignedIn())}getIdToken(){return this.tokenStore.currentIdToken?Promise.resolve(this.tokenStore.currentIdToken):this.tokenStore.refreshToken?this.refreshIdToken():Promise.reject(c.a.NotSignedIn())}getRefreshToken(){return this.tokenStore.refreshToken?Promise.resolve(this.tokenStore.refreshToken):this.tokenStore.currentToken?Promise.reject(c.a.NoRefreshToken()):Promise.reject(c.a.NotSignedIn())}invalidateToken(){return this.tokenStore.currentToken&&this.tokenStore.invalidateCurrentToken(),this.signOutCallback&&this.signOutCallback(),Promise.resolve()}refreshAccessToken(){return this.tokenStore.refreshToken?this.oauthManager.refreshAccessToken(this.tokenStore.refreshToken).then(e=>(this.tokenStore.persistTokenResponse(e),e.accessToken)).catch(e=>{throw this.tokenStore.clear(),this.userStore.clear(),e}):Promise.reject(c.a.NoRefreshToken())}refreshIdToken(){return this.tokenStore.refreshToken?this.oauthManager.refreshAccessToken(this.tokenStore.refreshToken).then(e=>(this.tokenStore.persistTokenResponse(e),e.idToken)).catch(e=>{throw this.tokenStore.clear(),this.userStore.clear(),e}):Promise.reject(c.a.NoRefreshToken())}signIn(e,t){let r;switch(e){case y.Redirect:r=this.oauthManager.signInRedirect(t);break;case y.Silent:return Promise.reject(c.a.UnsupportedAuthenticationMethod());default:r=this.oauthManager.signInPopup(t)}return r.then(e=>(this.tokenStore.persistTokenResponse(e),this.loadUser()))}connect(){return this.refreshAccessToken().then(()=>this.loadUser())}getUser(){return this.getOrFetchUser()}signInOrConnect(e=y.Popup,t){switch(this.authStatus){case N.Connected:return this.loadUser();case N.Expired:return this.connect();case N.NotConnected:return this.signIn(e,t)}}redirectCallback(){return this.oauthManager.redirectCallback().then(e=>(this.tokenStore.persistTokenResponse(e),this.loadUser()))}signOut(){return this.tokenStore.clear(),this.userStore.clear(),this.signOutCallback&&this.signOutCallback(),Promise.resolve()}getOrFetchUser(){const e=this.userStore.currentUser;return e?Promise.resolve(e):this.loadUser()}loadUser(){return this.getAccessToken().then(e=>this.oauthManager.requestUserInfo(e)).then(e=>P.fromJson(e)).then(e=>(this.userStore.set(e),e))}}var y,N,O=r(785),E=r(1415),U=r(1448);r(412),r(174);!function(e){e.Redirect="REDIRECT",e.Popup="POPUP",e.Silent="SILENT"}(y||(y={})),function(e){e.Connected="CONNECTED",e.Expired="EXPIRED",e.NotConnected="NOT_CONNECTED"}(N||(N={}));class _{constructor(e,t,r,n){this.engines=new Map,this.signoutHandlers=[],this.clientId=e,this.sdkVersion=h.p,this.authProvider=new C(e,t||window.location.href,r,n),document&&document.body?this.injectStyles():window.addEventListener("load",()=>{this.injectStyles()}),this.authProvider.signOutCallback=this.onSignOut.bind(this)}static callback(){Object(k.b)()}getProvider(e){const t=this.engines.get(JSON.stringify(e));if(t)return t.start(),t;let r={};e&&"string"!=typeof e&&(r=e);const n=this.networkFromProviderOptions(e),o=this.createProvider(n,r);return o.start(),this.engines.set(JSON.stringify(e),o),o}getConnectButton(e,t){return new O.a(this.authProvider,e,t)}start(e){return this.authProvider.signInOrConnect(void 0,e)}get authStatus(){return this.authProvider.authStatus}signIn(e){return this.authProvider.signIn(y.Popup,e)}getUser(){return this.authProvider.getUser()}connect(){return this.authProvider.connect()}signInRedirect(e){this.authProvider.signIn(y.Redirect,e)}redirectCallback(){return this.authProvider.redirectCallback()}getCurrentAccessToken(){return this.authProvider.getAccessToken()}getCurrentIdToken(){return this.authProvider.getIdToken()}getCurrentRefreshToken(){return this.authProvider.getRefreshToken()}addSignOutHandler(e){this.signoutHandlers.push(e)}removeSignOutHandler(e){const t=this.signoutHandlers.findIndex(t=>t===e);t>=0&&this.signoutHandlers.splice(t,1)}signOut(){return this.engines.forEach(e=>e.emit("signOut")),this.authProvider.signOut()}createProvider(e,t={}){return new E.a(this.clientId,this.authProvider,this.sdkVersion,e,t)}networkFromName(e){switch(e){case"":case"mainnet":return n.c;case"rinkeby":return n.f;case"polygon":return n.e;case"mumbai":return n.d;default:throw new Error(`Unsupported network name ${e}. Try passing a \`network\` in the options instead.`)}}networkFromProviderOptions(e){return e?"string"==typeof e?this.networkFromName(e):e.network?e.network:e.networkName?this.networkFromName(e.networkName):n.c:n.c}onSignOut(){this.signoutHandlers.forEach(e=>{e()})}injectStyles(){if(document.getElementById("BitskiEmbeddedStyles"))return;const style=document.createElement("style");style.setAttribute("type","text/css"),style.setAttribute("id","BitskiEmbeddedStyles"),style.appendChild(document.createTextNode(U.a));(document.head||document.getElementsByTagName("head")[0]).appendChild(style)}}}}]);