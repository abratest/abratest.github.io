(window.webpackJsonp=window.webpackJsonp||[]).push([[467],{2166:function(e,t,r){"use strict";r.r(t),r.d(t,"mutations",(function(){return W})),r.d(t,"getters",(function(){return J})),r.d(t,"state",(function(){return z})),r.d(t,"actions",(function(){return ne}));r(142),r(122),r(32),r(24),r(25),r(53),r(54),r(49),r(166),r(68);var n=r(43),c=(r(22),r(15),r(58),r(29)),o=(r(12),r(0)),d=r(10),l=r(1347),f=r(80),h=r(793),m=r(47),v=r(341),x=r(646),k=r(9),O=r(21),y=r(1),w=r(13),j=r(16),I=r(498),S=r(1348),R=r(97),T=r.n(R),L=r(40),P=r.n(L),B=r(44),N=r.n(B);function A(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,d=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){d=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(d)throw c}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function E(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function G(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?E(Object(source),!0).forEach((function(t){Object(d.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):E(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}Object(I.use)(S.Web3ClientPlugin),Object(I.setProofApi)("https://apis.matic.network/");var _="deposit",H="withdraw",D="processing",M="finished",F={gasLimit:null,maxFeePerGas:null,maxPriorityFeePerGas:null},W=G(G({},y.c),{},{setState:function(e,t){e[t.field]=t.value}}),J=y.b,z=function(){return{nfts:[],currentTx:{data:null,status:"success"},pendingTxHash:{data:null,status:"success"},approveLandTunnel:{data:null,status:"success"},bridgeTransactions:{data:null,status:"success"},tokensInMigration:{data:null,status:"success"},userTokens:{data:null,status:"success"},landQuads:{data:null,status:"success"},gasPrediction:{data:{deposit:{sand:0,land:0},withdrawn:{sand:0,land:0}},status:"loading"},tokensAlreadyMigrated:{data:null,status:"success"}}},Q=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,o,d,l,f,h,m,v=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(v.length>1&&void 0!==v[1])||v[1],n=v.length>2&&void 0!==v[2]&&v[2],o=r?{parent:"current",child:2,layer:"bridge_1"}:{parent:"bridge_1",child:"current",layer:2},e.next=5,Promise.all([Object(O.h)(o.parent),Object(O.h)(o.child)]);case 5:return d=e.sent,l=Object(c.a)(d,2),f=l[0],h=l[1],m=new I.POSClient,e.next=12,m.init({network:k.C?"testnet":"mainnet",version:k.C?"mumbai":"v1",log:k.C,parent:{provider:f,defaultConfig:{from:t}},child:{provider:h,defaultConfig:{from:t}}});case 12:if(n){e.next=15;break}return e.next=15,Object(O.l)(o.layer);case 15:return e.abrupt("return",m);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r,c,o,d){var l,f,h,data,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.methods[c]){e.next=3;break}return console.error("Invalid method name."),e.abrupt("return",null);case 3:return e.prev=3,f=(l=r.methods)[c].apply(l,Object(n.a)(o)),h=r.options.address,data=f.encodeABI(),e.next=9,t.eth.estimateGas({to:h,data:data,from:d});case 9:return m=e.sent,e.abrupt("return",Math.round(m));case 13:return e.prev=13,e.t0=e.catch(3),console.error("Error estimating gas limit.",{error:e.t0}),e.abrupt("return",void 0);case 17:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t,r,n,c,o){return e.apply(this,arguments)}}(),U=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:null,1===t||2===t){e.next=3;break}return e.abrupt("return","0");case 3:if(r){e.next=7;break}return e.next=6,Object(O.h)(t);case 6:r=e.sent;case 7:return e.prev=7,e.t1=r.utils,e.next=11,r.eth.getGasPrice();case 11:if(e.t2=e.sent,e.t2){e.next=14;break}e.t2="0";case 14:return e.t3=e.t2,e.next=17,e.t1.fromWei.call(e.t1,e.t3,"ether");case 17:if(e.t0=e.sent,e.t0){e.next=20;break}e.t0="0";case 20:return e.abrupt("return",e.t0);case 23:return e.prev=23,e.t4=e.catch(7),console.error("Error retrieving gas price per layer ".concat(t),e.t4),e.abrupt("return","0");case 27:case"end":return e.stop()}}),e,null,[[7,23]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r,n){var c,o,d,l,f,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=h.length>3&&void 0!==h[3]?h[3]:null,o=h.length>4&&void 0!==h[4]?h[4]:null,d=h.length>5&&void 0!==h[5]?h[5]:null,l=h.length>6&&void 0!==h[6]?h[6]:null,!t){e.next=11;break}return Object(O.a)(t,"pending",n,l),e.next=8,Object(O.h)(n);case 8:return f=e.sent,e.next=11,new Promise((function(e,l){Object(j.j)({txHash:t,from:r,web3:f,reject:l,resolve:e,cbSuccess:function(e){return Object(O.a)(e,"success",n,c)},cbFailure:function(e){return Object(O.a)(e,"error",n,o||d)},cbError:d})}));case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,c,o,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.length>2&&void 0!==d[2]?d[2]:null,c=localStorage.getItem("bridge_txs_".concat(t)),(o=c?JSON.parse(c):[])&&r&&(o=o.filter((function(e){return e.transactionId!==r})),Z(t,o,n));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),K=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r,n){var o,d,l,f,h,m,v,x,k,O,y,w,j=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=j.length>3&&void 0!==j[3]?j[3]:null,d=j.length>4&&void 0!==j[4]?j[4]:null,l=!(j.length>5&&void 0!==j[5])||j[5],f=j.length>6&&void 0!==j[6]&&j[6],h=localStorage.getItem("bridge_txs_".concat(t)),m=h?JSON.parse(h):[],v=G({type:r,currentStep:1,totalSteps:r===_?2:3,timestamp:Math.floor(Date.now()/1e3)},n),!o||f){e.next=15;break}return e.next=10,Promise.all([o.getTransactionHash(),o.getReceipt()]);case 10:x=e.sent,k=Object(c.a)(x,2),O=k[0],y=k[1],v=G(G({transactionId:O},y),v);case 15:return f&&(w=m.find((function(e){return e.transactionId===v.transactionId})),v=G(G({},w),v),m=m.filter((function(e){return e.transactionId!==v.transactionId}))),v.status=n.status||D,l&&d&&d("setCurrentTx",v),m.unshift(v),Z(t,m,d),e.abrupt("return",v);case 21:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),V=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n,c,o,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=(null==t?void 0:t.timestamp)||(null==r?void 0:r.timestamp))||null==t||!t.blockNumber){e.next=10;break}return c=t.type===H&&t.step<=2||t.type===_&&2===t.step?2:"bridge_1",e.next=5,Object(O.h)(c);case 5:return o=e.sent,e.next=8,o.eth.getBlock(t.blockNumber);case 8:d=e.sent,n=null==d?void 0:d.timestamp;case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;localStorage.setItem("bridge_txs_".concat(e),JSON.stringify(t)),r&&r("loadBridgeTransactions",!0)},ee=function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,c,o,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>1&&void 0!==d[1]?d[1]:3,e.prev=1,n=k.C?"mumbai":"matic",e.next=5,T.a.get("https://apis.matic.network/api/v1/".concat(n,"/exit-payload/").concat(t,"?eventSignature=0x8c5261668696ce22758910d05bab8f186d6eb247ceac2af2e82c7dc17669b036"));case 5:return c=e.sent,e.abrupt("return",c.data.result);case 9:if(e.prev=9,e.t0=e.catch(1),console.error("errored",null===e.t0||void 0===e.t0||null===(o=e.t0.response)||void 0===o?void 0:o.data),!(r>0)){e.next=16;break}return e.next=15,new Promise((function(e){return setTimeout(e,2e3)}));case 15:return e.abrupt("return",ee(t,r-1));case 16:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),te=function(e){var t=[],r=[],n=[];return Array.isArray(e)&&e.forEach((function(e){t.push(e.size),r.push(e.x),n.push(e.y)})),{sizes:t,xs:r,ys:n}},re=function(e){var t=[];if(!e)return t;var r,n=A(e.batches||[]);try{for(n.s();!(r=n.n()).done;){var c=r.value;t.push(c.map((function(t){var r,n=t,c=null===(r=e.lands)||void 0===r?void 0:r.find((function(e){return e.coordinateX===t.x-204&&e.coordinateY===t.y-204}));return c&&(n=G(G({},n),c)),n})))}}catch(e){n.e(e)}finally{n.f()}return t},ne={loadContractByLayer:function(e,t){var r=t.contractName,n=t.layer;return Object(O.i)(r,n,!0)},loadContractInfoByLayer:function(e,t){var r=t.contractName,n=t.layer;return Object(O.j)(r,n,!0)},getWeb3ByLayer:function(e,t){return Object(O.h)(t)},setAssets:function(e,t){!function(e,t,r){e("setState",{field:t,value:r})}(e.commit,"nfts",t.nfts)},setCurrentTx:function(e,t){var r=e.commit;Object(y.a)(r,"currentTx").success(t)},setPendingTxHash:function(e,t){var r=e.commit;Object(y.a)(r,"pendingTxHash").success(t)},depositERC20:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,d,l,f,h,m,v,k,I,S,R,T,L,B,N,A,C,E,G,H,D,M;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.commit,o=e.dispatch,d=e.rootGetters,l=t.amount,f=t.callbackSuccess,h=void 0===f?null:f,m=t.callbackFailure,v=void 0===m?null:m,k=t.callbackError,I=void 0===k?null:k,S=t.callbackPending,R=void 0===S?null:S,l){r.next=4;break}return r.abrupt("return");case 4:return T=Object(y.a)(n,"depositERC20"),r.prev=5,L=Object(O.b)(d),r.next=9,Object(j.m)();case 9:return B=P.a.utils.toWei("".concat(l)),r.next=12,Promise.all([Q(L),o("loadContractInfoByLayer",{contractName:"Sand",layer:"bridge_1"})]);case 12:return N=r.sent,A=Object(c.a)(N,2),C=A[0],E=A[1],G=C.erc20(E.address,!0),r.t0=x.a,r.next=20,G.getAllowance(L);case 20:if(r.t1=r.sent,r.t1){r.next=23;break}r.t1=0;case 23:if(r.t2=r.t1,!((0,r.t0)(r.t2,!1).comparedTo(l)<0)){r.next=33;break}return r.next=28,G.approveMax(F);case 28:return H=r.sent,r.next=31,H.getTransactionHash().then((function(e){Object(w.f)("pending",e,{},1)}));case 31:return r.next=33,H.getReceipt().then((function(e){Object(w.f)("success",e.transactionHash,{},1)}));case 33:return r.next=35,G.deposit(B,L,F);case 35:return D=r.sent,r.next=38,K(L,_,{currentStep:1,totalSteps:2,amount:l,weiAmount:B,token:"SAND"},D,o);case 38:return M=r.sent,X(M.transactionHash,L,"bridge_1",h,v,I,R),T.success(M.txHash),r.abrupt("return",M.txHash);case 44:r.prev=44,r.t3=r.catch(5),I&&I(r.t3),T.error(Object(y.d)(r.t3)),console.error(r.t3);case 49:case"end":return r.stop()}}),r,null,[[5,44]])})))()},startWithdrawERC20:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,d,l,f,h,m,v,x,k,I,S,R,T,L,B,N,A,C,E,G,_,D;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.commit,o=e.dispatch,d=e.rootGetters,l=t.amount,f=t.callbackSuccess,h=void 0===f?null:f,m=t.callbackFailure,v=void 0===m?null:m,x=t.callbackError,k=void 0===x?null:x,I=t.callbackPending,S=void 0===I?null:I,l){r.next=4;break}return r.abrupt("return");case 4:return R=Object(y.a)(n,"exitERC20"),r.prev=5,T=Object(O.b)(d),r.next=9,Object(j.m)();case 9:return L=P.a.utils.toWei("".concat(l)),r.next=12,Promise.all([Q(T,!1),o("loadContractInfoByLayer",{contractName:"Sand",layer:2})]);case 12:return B=r.sent,N=Object(c.a)(B,2),A=N[0],C=N[1],E=A.erc20(C.address),r.next=19,E.withdrawStart(L,F);case 19:return G=r.sent,r.next=22,K(T,H,{currentStep:1,totalSteps:3,amount:l,weiAmount:L,token:"SAND"},G,o);case 22:return _=r.sent,X(_.transactionHash,T,2,h,v,k,S),R.success(_.txHash),r.abrupt("return",_.txHash);case 28:r.prev=28,r.t0=r.catch(5),k&&k(r.t0),console.error(r.t0),r.t0.extra="startWithdrawERC20",D=Object(y.d)(r.t0),R.error(D),Object(w.d)({title:D});case 36:case"end":return r.stop()}}),r,null,[[5,28]])})))()},exitWithdrawERC20:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,d,l,f,h,m,v,x,k,w,I,S,R,T,L,P,B,N,A,C,E;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.commit,d=e.dispatch,l=e.rootGetters,f=t.burnTxHash,h=t.callbackSuccess,m=void 0===h?null:h,v=t.callbackFailure,x=void 0===v?null:v,k=t.callbackError,w=void 0===k?null:k,I=t.callbackPending,S=void 0===I?null:I,f){r.next=4;break}return r.abrupt("return");case 4:return R=Object(y.a)(n,"exitERC20"),r.prev=5,T=Object(O.b)(l),r.next=9,Object(j.m)();case 9:return r.next=11,Promise.all([Q(T),d("loadContractInfoByLayer",{contractName:"Sand",layer:"bridge_1"})]);case 11:return L=r.sent,P=Object(c.a)(L,2),B=P[0],N=P[1],A=B.erc20(N.address,!0),r.next=18,A.withdrawExitFaster(f,F);case 18:return C=r.sent,r.next=21,C.getTransactionHash();case 21:return E=r.sent,X(E,T,"bridge_1",Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(T,H,{transactionId:f,exitTxHash:E,currentStep:3,totalSteps:3,status:M,token:"SAND"},C,d,!0,!0);case 2:m&&m();case 3:case"end":return e.stop()}}),e)}))),x,w,S),R.success(E),r.abrupt("return",E);case 27:r.prev=27,r.t0=r.catch(5),w&&w(r.t0),R.error(Object(y.d)(r.t0)),console.error(r.t0);case 32:case"end":return r.stop()}}),r,null,[[5,27]])})))()},transferQuadFromLayer:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,c,o,d,l,f,m,v,x,k,j,I,S,R,T,L,P,B,N,C,E,G,D;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,c=e.dispatch,o=e.rootGetters,d=e.state,l=t.quads,f=void 0===l?null:l,m=t.blockchainIds,v=void 0===m?null:m,x=t.estateIds,k=void 0===x?null:x,j=t.layer,I=void 0===j?1:j,S=t.forward,R=void 0!==S&&S,T=t.gasless,L=void 0!==T&&T,P=t.callbackSuccess,B=void 0===P?null:P,N=t.callbackError,C=void 0===N?null:N,E=t.callbackPending,G=void 0===E?null:E,D=Object(y.a)(n,"transferQuadFromLayer"),r.prev=3,r.delegateYield(regeneratorRuntime.mark((function e(){var t,r,n,l,m,x,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=1===I?"bridge_1":I,r=Object(O.b)(o),!f){e.next=6;break}n=[f],e.next=10;break;case 6:return e.next=8,h.a.getBatches({blockchainIds:v,estates:k,fromLayer:I,includeLandId:!0});case 8:l=e.sent,n=re(l);case 10:m=A(n),e.prev=11,y=regeneratorRuntime.mark((function e(){var n,o,l,f,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.value,o=te(n),l=o.sizes,f=o.xs,h=o.ys,e.next=4,c("biconomy/callBiconomyTx",{method:"batchTransferQuadToL".concat(1===I?2:1),params:[r,l,f,h,"0x"],sendParams:{from:r},contractName:"LandTunnel",layer:t,callbackError:function(){var e=d.pendingTxHash.data;$(r,e,c),C&&C()},callbackPending:function(e){var t=n.reduce((function(e,t){return e+t.size*t.size}),0);K(r,1===I?_:H,{transactionId:e,currentStep:0,totalSteps:1===I?2:3,amount:t,weiAmount:t,token:"LAND",tokens:n,blockchainIds:n.map((function(e){return e.blockchainId}))},null,c,!1),c("setPendingTxHash",e),G&&G()},callbackSuccess:function(e){K(r,1===I?_:H,{transactionId:e,currentStep:1},null,c,!1,!0),B&&B()},forward:R&&2===I,gasless:L&&2===I},{root:!0});case 4:case"end":return e.stop()}}),e)})),m.s();case 14:if((x=m.n()).done){e.next=18;break}return e.delegateYield(y(),"t0",16);case 16:e.next=14;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(11),m.e(e.t1);case 23:return e.prev=23,m.f(),e.finish(23);case 26:D.success(void 0);case 27:case"end":return e.stop()}}),e,null,[[11,20,23,26]])}))(),"t0",5);case 5:r.next=12;break;case 7:r.prev=7,r.t1=r.catch(3),C&&C(r.t1),D.error(Object(y.d)(r.t1)),Object(w.d)({title:r.t1});case 12:case"end":return r.stop()}}),r,null,[[3,7]])})))()},approveLandTunnel:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,d,l,f,h,m,v,x,k,I,S,R,T,L,P,B,N,A,C;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=e.dispatch,d=e.rootGetters,l=t.layer,f=void 0===l?1:l,h=t.forward,m=void 0!==h&&h,v=t.gasless,x=void 0!==v&&v,k=t.callbackSuccess,I=void 0===k?null:k,S=t.callbackError,R=void 0===S?null:S,T=Object(y.a)(n,"approveLandTunnel"),r.prev=3,L=1===f?"bridge_1":f,P=Object(O.b)(d),r.next=8,Object(j.m)();case 8:return r.next=10,Object(O.l)(L);case 10:return r.next=12,Promise.all([o("loadContractByLayer",{contractName:"LandNew",layer:"current"}),o("loadContractInfoByLayer",{contractName:"LandTunnel",layer:L})]);case 12:return B=r.sent,N=Object(c.a)(B,2),A=N[0],C=N[1],r.next=18,A.methods.isApprovedForAll(P,C.address).call();case 18:if(!r.sent){r.next=22;break}return I&&I(),r.abrupt("return");case 22:return r.next=24,o("biconomy/callBiconomyTx",{method:"setApprovalForAll",params:[C.address,!0],sendParams:{from:P},contractName:"LandNew",layer:L,callbackSuccess:I,callbackError:R,forward:m&&2===f,gasless:x&&2===f,skipSwitch:!0},{root:!0});case 24:r.next=30;break;case 26:r.prev=26,r.t0=r.catch(3),T.error(Object(y.d)(r.t0)),Object(w.d)({title:r.t0});case 30:case"end":return r.stop()}}),r,null,[[3,26]])})))()},exitLand:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,c,o,d,l,f,h,m,v,x,k,I,S,R,T,L,P;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,c=e.dispatch,o=e.rootGetters,d=t.burnTxHash,l=t.callbackSuccess,f=void 0===l?null:l,h=t.callbackError,m=void 0===h?null:h,v=t.callbackFailure,x=void 0===v?null:v,k=t.callbackPending,I=void 0===k?null:k,S=Object(y.a)(n,"exitLand"),r.prev=3,R=Object(O.b)(o),r.next=7,Object(j.m)();case 7:return r.next=9,Object(O.l)("bridge_1");case 9:return r.next=11,c("loadContractByLayer",{contractName:"LandTunnel",layer:"current"});case 11:return T=r.sent,r.next=14,ee(d);case 14:if(L=r.sent){r.next=17;break}throw new Error("Proof is empty");case 17:return r.next=19,Object(j.d)(T,"receiveMessage",[L],{from:R},(function(e){return Object(O.a)(e,"success","bridge_1",(function(){K(R,H,{transactionId:d,exitTxHash:e,currentStep:3,totalSteps:3,status:M,token:"LAND"},null,c,!1,!0),f&&f()}))}),(function(e){return Object(O.a)(e,"error","bridge_1",m)}),x);case 19:P=r.sent,Object(O.a)(P,"pending","bridge_1",I),S.success(P),r.next=28;break;case 24:r.prev=24,r.t0=r.catch(3),S.error(Object(y.d)(r.t0)),Object(w.d)({title:r.t0});case 28:case"end":return r.stop()}}),r,null,[[3,24]])})))()},depositERC1155:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,c,o,d,l,f,data,h,m,v,x,k;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.commit,c=e.dispatch,o=e.rootGetters,d=t.tokenIds,l=t.amounts,f=t.data,data=void 0===f?"0x0":f,d&&0!==d.length&&l&&0!==l.length){r.next=4;break}return r.abrupt("return");case 4:return h=Object(y.a)(n,"depositERC1155"),r.prev=5,m=Object(O.b)(o),r.next=9,Q();case 9:return v=r.sent,r.next=12,c("loadContractInfoByLayer",{contractName:"Asset",layer:1});case 12:if(x=r.sent){r.next=15;break}throw new Error("Token contract not found");case 15:return r.next=17,v.depositBatchERC1155ForUser(x.address,m,d,l,data,{from:m,gasPrice:"10000000000"});case 17:return k=r.sent,h.success(k),r.abrupt("return",k);case 22:r.prev=22,r.t0=r.catch(5),h.error(Object(y.d)(r.t0)),console.error(r.t0);case 26:case"end":return r.stop()}}),r,null,[[5,22]])})))()},checkDepositMethod:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,d,l,f,h,m,v,x,k,O;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=e.dispatch,d=Object(y.a)(n,"checkDepositMethod"),r.prev=2,r.next=5,Promise.all([o("getWeb3ByLayer",1),o("getWeb3ByLayer",2)]);case 5:if(l=r.sent,f=Object(c.a)(l,2),h=f[0],m=f[1],v=new m.eth.Contract([{constant:!0,inputs:[],name:"lastStateId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],"0x0000000000000000000000000000000000001001")){r.next=12;break}throw new Error("Contract not found");case 12:return r.next=14,h.eth.getTransactionReceipt(t);case 14:return x=r.sent,r.next=17,v.methods.lastStateId().call();case 17:return k=r.sent,O=h.utils.hexToNumberString(x.logs.filter((function(e){return"0x103fed9db65eac19c4d870f49ab7520fe03b99f1838e5996caf47e9e43308392"===e.topics[0]}))[0].topics[1]),d.success(k>=O),r.abrupt("return",k>=O);case 23:r.prev=23,r.t0=r.catch(2),d.error(Object(y.d)(r.t0)),Object(w.d)({title:r.t0});case 27:case"end":return r.stop()}}),r,null,[[2,23]])})))()},updateTransactions:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,c,o,d,l,f,h,m,v,x,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.rootGetters,n=e.dispatch,t.prev=1,c=Object(O.b)(r),t.next=5,Q(c,!0,!0);case 5:o=t.sent,d=localStorage.getItem("bridge_txs_".concat(c)),l=d?JSON.parse(d):[],f=[],h=A(l),t.prev=10,h.s();case 12:if((m=h.n()).done){t.next=36;break}if((v=m.value).status!==D){t.next=33;break}if(0!==(x=v.currentStep>=0?v.currentStep:1)){t.next=18;break}return t.abrupt("continue",34);case 18:if(v.type!==H){t.next=32;break}if(1!==x){t.next=32;break}if(k=!1,"SAND"!==v.token){t.next=27;break}return t.next=24,o.isCheckPointed(v.transactionId).catch((function(){return!1}));case 24:k=t.sent,t.next=31;break;case 27:if("LAND"!==v.token){t.next=31;break}return t.next=30,ee(v.transactionId,0);case 30:k=!!t.sent;case 31:k&&(x=2);case 32:v.currentStep=x;case 33:f.push(v);case 34:t.next=12;break;case 36:t.next=41;break;case 38:t.prev=38,t.t0=t.catch(10),h.e(t.t0);case 41:return t.prev=41,h.f(),t.finish(41);case 44:Z(c,f,n),t.next=50;break;case 47:t.prev=47,t.t1=t.catch(1),Object(w.d)({title:t.t1});case 50:case"end":return t.stop()}}),t,null,[[1,47],[10,38,41,44]])})))()},loadBridgeTransactions:function(e){var t=arguments;return Object(o.a)(regeneratorRuntime.mark((function r(){var c,o,d,f,h,m,v,j,I,S,R,T,L,P,B;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=e.commit,o=e.rootGetters,d=e.dispatch,f=t.length>1&&void 0!==t[1]&&t[1],h=Object(y.a)(c,"bridgeTransactions"),r.prev=3,m=[],v=Object(O.b)(o),j=localStorage.getItem("bridge_txs_".concat(v)),I=j?JSON.parse(j):[],!f){r.next=12;break}return h.success(I.filter((function(e){return!e.hide}))),d("getTokensInMigrationProcess"),r.abrupt("return");case 12:return r.next=14,l.a.getTransactions({walletAddress:v,limit:k.h.historyLimit});case 14:S=r.sent,R=[],S.rows.forEach((function(e){var t=e.BridgeOperationLogs&&e.BridgeOperationLogs[0]&&e.BridgeOperationLogs[0].BlockchainLog,r=R.find((function(e){var r,n,c;return(null===(r=e.BridgeOperationLogs)||void 0===r||null===(n=r[0])||void 0===n||null===(c=n.BlockchainLog)||void 0===c?void 0:c.txId)==(null==t?void 0:t.txId)}));if(t){if(!r){(null!=t&&t.txId?S.rows.filter((function(e,i,r){var n,c,o;return r.findIndex((function(t){return t.blockchainId===e.blockchainId}))!==i&&(null===(n=e.BridgeOperationLogs)||void 0===n||null===(c=n[0])||void 0===c||null===(o=c.BlockchainLog)||void 0===o?void 0:o.txId)==(null==t?void 0:t.txId)})):[]).forEach((function(t){var r;return(r=e.BridgeOperationTokens).push.apply(r,Object(n.a)(t.BridgeOperationTokens))})),R.push(e)}}else R.push(e)})),S.rows=R,T={sand:"SAND",asset:"ASSET",land:"LAND",landnew:"LAND"},L=A(S.rows||[]),r.prev=20,B=regeneratorRuntime.mark((function e(){var t,r,n,c,o,d,l,f,h,v,O,y,w,j,S,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=P.value,o=c.BridgeOperationTokens&&c.BridgeOperationTokens[0]||{},(d=T[null==o||null===(t=o.Token)||void 0===t||null===(r=t.Contract)||void 0===r||null===(n=r.name)||void 0===n?void 0:n.toLowerCase()]||T.sand)!==T.sand&&(l=c.BridgeOperationTokens.filter((function(e,i,t){return t.findIndex((function(t){var r,n;return(null==t||null===(r=t.Token)||void 0===r?void 0:r.blockchainId)===(null==e||null===(n=e.Token)||void 0===n?void 0:n.blockchainId)}))===i})),c.BridgeOperationTokens=l,f=c.BridgeOperationLogs.filter((function(e,i,t){return t.findIndex((function(t){var r,n;return(null===(r=t.BlockchainLog)||void 0===r?void 0:r.txId)==(null===(n=e.BlockchainLog)||void 0===n?void 0:n.txId)}))===i})),c.BridgeOperationLogs=f),(h=(c.BridgeOperationLogs||[]).map((function(e){var t,r;return{step:null==e?void 0:e.step,transactionId:null==e||null===(t=e.BlockchainLog)||void 0===t?void 0:t.txId,blockNumber:null==e||null===(r=e.BlockchainLog)||void 0===r?void 0:r.blockNumber}}))).sort((function(a,b){return a.step-b.step})),v=h[0]||{},O=I.find((function(e){return e.transactionId===v.transactionId})),!(O&&O.currentStep>=c.currentStep&&O.stepsLogs&&O.stepsLogs.length===h.length&&O.blockchainIds&&O.blockchainIds.length===c.BridgeOperationTokens.length)){e.next=13;break}m.push(O),e.next=22;break;case 13:return y=o.amount||0,y=d===T.sand?Object(x.a)(o.amount||0):(null===(w=c.BridgeOperationTokens)||void 0===w?void 0:w.length)||y,j=G(G({type:c.type,status:c.status,totalSteps:c.totalSteps,currentStep:c.currentStep,stepsLogs:h},v),{},{token:d,amount:y,weiAmount:d===T.sand?o.amount:y}),e.next=18,V(j,O);case 18:j.timestamp=e.sent,j.token===T.land&&(R=null===(S=c.BridgeOperationTokens)||void 0===S?void 0:S.map((function(e){var t;return null===(t=e.Token)||void 0===t?void 0:t.blockchainId})),j.blockchainIds=R),j.token===T.sand&&(j.hide=N.a.unix(k.h.historyStartDate).isAfter(N.a.unix(j.timestamp))),m.push(j);case 22:case"end":return e.stop()}}),e)})),L.s();case 23:if((P=L.n()).done){r.next=27;break}return r.delegateYield(B(),"t0",25);case 25:r.next=23;break;case 27:r.next=32;break;case 29:r.prev=29,r.t1=r.catch(20),L.e(r.t1);case 32:return r.prev=32,L.f(),r.finish(32);case 35:m.push.apply(m,Object(n.a)(I.filter((function(e){return!m.find((function(t){return t.transactionId===e.transactionId}))})))),m.sort((function(a,b){return a.timestamp>b.timestamp?-1:a.timestamp<b.timestamp?1:0})),localStorage.setItem("bridge_txs_".concat(v),JSON.stringify(m)),h.success(m.filter((function(e){return!e.hide}))),d("getTokensInMigrationProcess"),d("updateTransactions"),r.next=47;break;case 43:r.prev=43,r.t2=r.catch(3),h.error(Object(y.d)(r.t2)),Object(w.d)({title:r.t2});case 47:case"end":return r.stop()}}),r,null,[[3,43],[20,29,32,35]])})))()},getTokensInMigrationProcess:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,c,d,l,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.commit,n=e.rootGetters,c=Object(y.a)(r,"tokensInMigration"),t.prev=2,d=n["bridge/get"]("bridgeTransactions")){t.next=6;break}return t.abrupt("return");case 6:return l={lands:[],count:{eth:0,polygon:0,actionRequired:0}},d.forEach((function(e){e.status===D&&("LAND"===e.token&&l.lands.push(e),e.type===_?l.count.eth++:l.count.polygon++,e.type===H&&e.currentStep>1&&l.count.actionRequired++)})),t.next=10,l.lands.reduce(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(t=e.sent,!r.blockchainIds||!r.blockchainIds.length){e.next=8;break}return e.next=6,m.a.searchLands({blockchainIds:r.blockchainIds}).then((function(e){var t;return(null==e||null===(t=e.data)||void 0===t?void 0:t.rows)||[]}));case 6:e.sent.forEach((function(e){t.tokens.find((function(t){return t.blockchainId&&t.blockchainId===e.blockchainId||t.id&&t.id===e.id}))||(t.tokens.push(G(G({},e),{},{transactionId:r.transactionId,layer:r.type===_?1:2})),e.type?t.estateIds.push(e.id):t.blockchainIds.push(e.blockchainId))}));case 8:return e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),{tokens:[],blockchainIds:[],estateIds:[]});case 10:f=t.sent,c.success(G(G({},f),{},{count:l.count})),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),c.error(Object(y.d)(t.t0)),Object(w.d)({title:t.t0});case 18:case"end":return t.stop()}}),t,null,[[2,14]])})))()},loadUserTokens:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o,d,l,h,v,x,k,j,I,S,R,T;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.commit,o=Object(y.a)(r,"userTokens"),t.prev=2,t.next=5,Promise.all([m.a.getPurchased().then((function(e){var t,r,n;return(null==e||null===(t=e.data)||void 0===t||null===(r=t.purchased)||void 0===r||null===(n=r.rows)||void 0===n?void 0:n.filter((function(e){return e.migrated})))||[]})),f.a.getPurchased({chainId:Object(O.e)(1)}).then((function(e){var t,r;return(null==e||null===(t=e.data)||void 0===t||null===(r=t.purchased)||void 0===r?void 0:r.rows)||[]})),f.a.getPurchased({chainId:Object(O.e)(2)}).then((function(e){var t,r;return(null==e||null===(t=e.data)||void 0===t||null===(r=t.purchased)||void 0===r?void 0:r.rows)||[]}))]);case 5:h=t.sent,v=Object(c.a)(h,3),x=v[0],k=v[1],j=v[2],I={ethereum:[],polygon:[]},S=A(x);try{for(S.s();!(R=S.n()).done;)T=R.value,1===Object(O.d)(T.chainId)?I.ethereum.push(T):I.polygon.push(T)}catch(e){S.e(e)}finally{S.f()}(d=I.ethereum).push.apply(d,Object(n.a)(k)),(l=I.polygon).push.apply(l,Object(n.a)(j)),o.success(I),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(2),o.error(Object(y.d)(t.t0)),Object(w.d)({title:t.t0});case 22:case"end":return t.stop()}}),t,null,[[2,18]])})))()},predictGases:function(e,t){return Object(o.a)(regeneratorRuntime.mark((function r(){var n,c,d,l,f,m,v,x,w,j,I,S,R,T;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,c=e.rootGetters,d=e.dispatch,l=t.direction,f=t.token,m=t.payload,v=Object(y.a)(n,"gasPrediction"),r.prev=3,x={deposit:{sand:[{contractName:"RootChainManagerProxy",layer:1,method:"depositFor"}],land:[{contractName:"LandTunnel",layer:1,method:"batchTransferQuadToL2",defaultGas:157701}]},withdraw:{sand:[{contractName:"Sand",layer:2,method:"withdraw"},{contractName:"RootChainManagerProxy",layer:1,method:"exit",defaultGas:k.C?280500:36509}],land:[{contractName:"LandTunnel",layer:2,method:"batchTransferQuadToL1",defaultGas:160678},{contractName:"LandTunnel",layer:1,method:"receiveMessage",defaultGas:1442529}]}},w=x[l][f],j=[],w.forEach((function(e){j.push(Object(O.h)(e.layer).then((function(t){return e.web3=t})))})),r.next=10,Promise.all(j);case 10:return j=[],w.forEach((function(e){j.push(d("loadContractInfoByLayer",{contractName:e.contractName,layer:e.layer}).then((function(t){return e.contractInfo=t})))})),r.next=14,Promise.all(j);case 14:return w.forEach((function(e){e.contract=new e.web3.eth.Contract(e.contractInfo.abi,e.contractInfo.address)})),I=Object(O.b)(c),r.next=18,Promise.all(w.map(function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(t){var r,n,c,o,v,x,k,O,y,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.estimatedGas){e.next=2;break}return e.abrupt("return");case 2:if("sand"!==f){e.next=20;break}return e.t0=t.web3.utils,e.t1=t.web3.utils,e.next=7,t.web3.utils.toWei(m.toString());case 7:return e.t2=e.sent,e.next=10,e.t1.toHex.call(e.t1,e.t2);case 10:return e.t3=e.sent,e.next=13,e.t0.padLeft.call(e.t0,e.t3,64);case 13:if(r=e.sent,"deposit"!==l){e.next=19;break}return e.next=17,d("loadContractInfoByLayer",{contractName:"Sand",layer:t.layer});case 17:n=e.sent,t.methodParams=[I,n.address,r];case 19:"withdraw"===l&&(2===t.layer&&(t.methodParams=[r]),1===t.layer&&(t.methodParams=["0xf909e7842aec28c0b9010052f8d7cf5af97e5e4ca6fd43f7a6a96783ffb84692e932bda43baf291f0bf62187166163b5cbca1d2c230471e6d7cb7dde38523f7672a670115084bd47178d2dcf507339ec8b48fe9443a1a5abc99dd7fdf3976d47afadb6c383b4b2483c55bdde179678bfa9e8a3c4b41901c3f4a2dd4ff0451724e6b4e1d8a5d8731d31598ff52f885def708d12f5fb29a75664648a0467965f539c3ef8be0ffe734099939fd12a9275ac9d1c8a586d348e776180df125ff7e78bce176c05aa90d892c21840e4763a7b8efb1bcaf9b02afa4abf9059261419f34765298ccfbaa99fb95c36fecefd312ec7f5089b6560922eb50ddafce51bfe01ec01984066742ebf5ae581a7840187971d84623df289a03bcc29133779b3b5c24a616b30dcfe6e6f40005deb902555a96e9097cb039dfba08c6c3b0b2b9921e793d11de39c500118d25d55f386f9b4bd1448aba574060080b902ec02f902e801835bfb7fb9010000000000000000020000000000000000000000000000000000000000000200000000000000000000000000000000000000008000000000000000020040000000000000000000000000000008000000800000000000000000000100000000000000000000020000000000000000000800000000000000000080000010000000000000000000000000000000000000000000000000000000004000000000000000200000000002000020000000000000000001000000000000000000002000004000000002000000000001000000000000000000000000000000100000000020000000000000000000000000000000000000000000000000000000000000100000f901ddf89b94592daadc9ea7f56a81de1fd27a723bd407709c46f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000212c810ab431020a16b06e11997d39f3b67b0606a00000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000002386f26fc10000f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000212c810ab431020a16b06e11997d39f3b67b0606a0000000000000000000000000c26880a0af2ea0c7e8130e6ec47af756465452e8b8a00000000000000000000000000000000000000000000000000000530308f0b5000000000000000000000000000000000000000000000000007af5ffe0e11a1c9e0000000000000000000000000000000000000000000008fb68a797840aca7aa90000000000000000000000000000000000000000000000007af5acddd829679e0000000000000000000000000000000000000000000008fb68a7ea8713bb2fa9b9059df9059af891a0620827adf5dfc476cd1cf8a18ca2dbc61876109e105163ae45aa8df576b04b35a07331c573d5228d0876e25af3ecf1f085027b3f6297d5a4344c51d8459e732227a0d7ca200764b247efbee7cf311e752be491e1d4feac227d76cecb1b4a4ea67f268080808080a0904baf3f06c484b4594155f2bc01185735a440be0a2d4593af0d0574cc4ecceb8080808080808080f90211a01db20ed737e40e8b20523cf3c6c251217eb5ff0776decab50539044433f2f7b5a036a0b792e6dc1549b5ecec993b41fe7e55d44e47119686a97c332cf73739316aa0d1833a6149a4dec8ed691272bb214aab4d199346b35d142332f86f7457685962a0e2a12c06cfbd14ca86076f07c2fcbecf6e2c5cea0497567f986ee3931e150157a077ead6ae710cae80f61a1910a2d9fe0057a9ab37da6b717a01c73735dd9456b4a050ab3f98caaae1609da43e6f2a79bfd95f121491820297b7de77e42ae42f68d6a09b1a448f398fe2ccacf31780ccfd98f13adc0a7cb864cb8985dd21bb5ab11c64a0e6c3fd34a3aa94cc3a19a338d22906126c538ded71faf82b838c393e0bc08cb6a0d15ce4cb872b1969624b8af7bc2c053af8ad5613bbd36d6431fcd32ea785f5c1a02016aca72b7c308bbb92f592e029b1e665240d0313d3088ae180a87bdd82a36ea072b31f681dc377c94b2d1c8eb651fc7b90c19401103f3d9ee3052d12c669592fa08f947507a10d52abf5c02691a915a549c95192ad72cbfa62003e858724031084a07d040724d750fb84bbbce8d102134d27feab09e3e2586716cccb0b8c9a9b65a0a016fbd06a300cb17e1407c0b1393ea620fd8f9b4985c76c6a4d492f3bb038811ca03a39d6976d8001b36ade2e41f752b425654d1404765e893043672d73f09560eea06d591212d98c57072b181e65cf0b8e6e0ec2b6b58e91a53fe88fb0f35bf4bc6f80f902f020b902ec02f902e801835bfb7fb9010000000000000000020000000000000000000000000000000000000000000200000000000000000000000000000000000000008000000000000000020040000000000000000000000000000008000000800000000000000000000100000000000000000000020000000000000000000800000000000000000080000010000000000000000000000000000000000000000000000000000000004000000000000000200000000002000020000000000000000001000000000000000000002000004000000002000000000001000000000000000000000000000000100000000020000000000000000000000000000000000000000000000000000000000000100000f901ddf89b94592daadc9ea7f56a81de1fd27a723bd407709c46f863a0ddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3efa0000000000000000000000000212c810ab431020a16b06e11997d39f3b67b0606a00000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000002386f26fc10000f9013d940000000000000000000000000000000000001010f884a04dfe1bbbcf077ddc3e01291eea2d5c70c2b422b415d95645b9adcfd678cb1d63a00000000000000000000000000000000000000000000000000000000000001010a0000000000000000000000000212c810ab431020a16b06e11997d39f3b67b0606a0000000000000000000000000c26880a0af2ea0c7e8130e6ec47af756465452e8b8a00000000000000000000000000000000000000000000000000000530308f0b5000000000000000000000000000000000000000000000000007af5ffe0e11a1c9e0000000000000000000000000000000000000000000008fb68a797840aca7aa90000000000000000000000000000000000000000000000007af5acddd829679e0000000000000000000000000000000000000000000008fb68a7ea8713bb2fa982001880"]));case 20:if("land"!==f){e.next=41;break}if("withdraw"!==l||1!==t.layer){e.next=29;break}if("string"!=typeof m){e.next=26;break}return e.next=25,ee(m);case 25:c=e.sent;case 26:c?t.methodParams=[c]:t.estimatedGas=t.defaultGas,e.next=41;break;case 29:if(o=Array.isArray(m)?m:[],!(v=o.reduce((function(e,t){return t.type?e.estateIds.push(t.id):e.blockchainIds.push(t.blockchainId),e}),{blockchainIds:[],estateIds:[]})).blockchainIds.length&&!v.estateIds.length){e.next=37;break}return e.next=34,h.a.getBatches(G(G({},v),{},{fromLayer:t.layer})).then((function(e){var t;return(null==e||null===(t=e.batches)||void 0===t?void 0:t[0])||[]}));case 34:e.t4=e.sent,e.next=38;break;case 37:e.t4=[];case 38:x=e.t4,k=te(x)||{},O=k.sizes,y=k.xs,w=k.ys,O&&y&&w?t.methodParams=[I,O,y,w,"0x"]:t.estimatedGas=t.defaultGas;case 41:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 18:return j=[],w.forEach((function(e){e.estimatedGas||j.push(Y(e.web3,e.contract,e.method,e.methodParams,I).then((function(t){return e.estimatedGas=t||e.defaultGas})))})),r.next=22,Promise.all(j);case 22:return j=[],w.forEach((function(e){j.push(U(e.layer).then((function(t){return e.gasPrice=t})))})),r.next=26,Promise.all(j);case 26:S={},w.forEach((function(e){S["gasFeeL"+e.layer]=e.estimatedGas*e.gasPrice})),R=c["bridge/get"]("gasPrediction")||{deposit:{},withdraw:{}},(T=JSON.parse(JSON.stringify(R)))[l][f]=S,v.success(T),r.next=38;break;case 34:r.prev=34,r.t0=r.catch(3),v.error(Object(y.d)(r.t0)),console.error("Error in gas price prediction: "+r.t0);case 38:case"end":return r.stop()}}),r,null,[[3,34]])})))()},loadTokensAlreadyMigrated:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,n,c,o,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.commit,n=Object(y.a)(r,"tokensAlreadyMigrated"),t.prev=2,t.next=5,v.a.getAllCashbacks({});case 5:if(c=t.sent,!((o=((null==c?void 0:c.cashbacks)||[]).reduce((function(e,t){return e.blockchainIds.push(t.tokenId),e.tokens.push({blockchainId:t.tokenId,migratedAt:t.createdAt}),e}),{blockchainIds:[],tokens:[]})).blockchainIds.length>0)){t.next=13;break}return t.next=10,f.a.getPurchased({blockchainIds:o.blockchainIds}).then((function(e){var t,r;return(null==e||null===(t=e.data)||void 0===t||null===(r=t.purchased)||void 0===r?void 0:r.rows)||[]}));case 10:t.t0=t.sent,t.next=14;break;case 13:t.t0=[];case 14:d=t.t0,n.success({estates:d.map((function(e){return e.id})),tokens:o.tokens}),t.next=22;break;case 18:t.prev=18,t.t1=t.catch(2),n.error(Object(y.d)(t.t1)),Object(w.d)({title:t.t1});case 22:case"end":return t.stop()}}),t,null,[[2,18]])})))()}}}}]);