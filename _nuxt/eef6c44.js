(window.webpackJsonp=window.webpackJsonp||[]).push([[190],{1416:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r={};n.r(r),n.d(r,"Express",(function(){return l})),n.d(r,"Postgres",(function(){return y})),n.d(r,"Mysql",(function(){return O})),n.d(r,"Mongo",(function(){return x})),n.d(r,"BrowserTracing",(function(){return T.a}));var o=n(329),c=n(4),d=n(38),h=n(34),l=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}return t.prototype.setupOnce=function(){this._router?function(t,e){void 0===e&&(e=[]);e.forEach((function(e){return function(t,e){var n=t[e];return t[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n.call.apply(n,Object(c.__spread)([this],f(t,e)))},t}(t,e)}))}(this._router,this._methods):h.a&&d.c.error("ExpressIntegration is missing an Express instance")},t.id="Express",t}();function m(t,e){var n=t.length;switch(n){case 2:return function(n,r){var o=r.__sentry_transaction;if(o){var c=o.startChild({description:t.name,op:"express.middleware."+e});r.once("finish",(function(){c.finish()}))}return t.call(this,n,r)};case 3:return function(n,r,o){var d,span=null===(d=r.__sentry_transaction)||void 0===d?void 0:d.startChild({description:t.name,op:"express.middleware."+e});t.call(this,n,r,(function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null===(t=span)||void 0===t||t.finish(),o.call.apply(o,Object(c.__spread)([this],e))}))};case 4:return function(n,r,o,d){var h,span=null===(h=o.__sentry_transaction)||void 0===h?void 0:h.startChild({description:t.name,op:"express.middleware."+e});t.call(this,n,r,o,(function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null===(t=span)||void 0===t||t.finish(),d.call.apply(d,Object(c.__spread)([this],e))}))};default:throw new Error("Express middleware takes 2-4 arguments. Got: "+n)}}function f(t,e){return t.map((function(t){return"function"==typeof t?m(t,e):Array.isArray(t)?t.map((function(a){return"function"==typeof a?m(a,e):a})):t}))}var v=n(206),object=n(67),_=n(52),y=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._usePgNative=!!e.usePgNative}return t.prototype.setupOnce=function(t,e){var n,r=Object(v.c)("pg");if(r)if(!this._usePgNative||(null===(n=r.native)||void 0===n?void 0:n.Client)){var o=(this._usePgNative?r.native:r).Client;Object(object.e)(o.prototype,"query",(function(t){return function(n,r,o){var c,d,h,span=null===(d=null===(c=e().getScope())||void 0===c?void 0:c.getSpan())||void 0===d?void 0:d.startChild({description:"string"==typeof n?n:n.text,op:"db"});if("function"==typeof o)return t.call(this,n,r,(function(t,e){var n;null===(n=span)||void 0===n||n.finish(),o(t,e)}));if("function"==typeof r)return t.call(this,n,(function(t,e){var n;null===(n=span)||void 0===n||n.finish(),r(t,e)}));var l=void 0!==r?t.call(this,n,r):t.call(this,n);return Object(_.n)(l)?l.then((function(t){var e;return null===(e=span)||void 0===e||e.finish(),t})):(null===(h=span)||void 0===h||h.finish(),l)}}))}else h.a&&d.c.error("Postgres Integration was unable to access 'pg-native' bindings.");else h.a&&d.c.error("Postgres Integration was unable to require `pg` package.")},t.id="Postgres",t}(),O=function(){function t(){this.name=t.id}return t.prototype.setupOnce=function(t,e){var n=Object(v.c)("mysql/lib/Connection.js");n?Object(object.e)(n,"createQuery",(function(t){return function(n,r,o){var c,d,span=null===(d=null===(c=e().getScope())||void 0===c?void 0:c.getSpan())||void 0===d?void 0:d.startChild({description:"string"==typeof n?n:n.sql,op:"db"});return"function"==typeof o?t.call(this,n,r,(function(t,e,n){var r;null===(r=span)||void 0===r||r.finish(),o(t,e,n)})):"function"==typeof r?t.call(this,n,(function(t,e,n){var o;null===(o=span)||void 0===o||o.finish(),r(t,e,n)})):t.call(this,n,r,o)}})):h.a&&d.c.error("Mysql Integration was unable to require `mysql` package.")},t.id="Mysql",t}(),I=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],j={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]},x=function(){function t(e){void 0===e&&(e={}),this.name=t.id,this._operations=Array.isArray(e.operations)?e.operations:I,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}return t.prototype.setupOnce=function(t,e){var n=this._useMongoose?"mongoose":"mongodb",r=Object(v.c)(n);r?this._instrumentOperations(r.Collection,this._operations,e):h.a&&d.c.error("Mongo Integration was unable to require `"+n+"` package.")},t.prototype._instrumentOperations=function(t,e,n){var r=this;e.forEach((function(e){return r._patchOperation(t,e,n)}))},t.prototype._patchOperation=function(t,e,n){if(e in t.prototype){var r=this._getSpanContextFromOperationArguments.bind(this);Object(object.e)(t.prototype,e,(function(t){return function(){for(var o,d,h,l,m=[],f=0;f<arguments.length;f++)m[f]=arguments[f];var v=m[m.length-1],y=n().getScope(),O=null===(o=y)||void 0===o?void 0:o.getSpan();if("function"!=typeof v||"mapReduce"===e&&2===m.length){var I=null===(d=O)||void 0===d?void 0:d.startChild(r(this,e,m)),j=t.call.apply(t,Object(c.__spread)([this],m));return Object(_.n)(j)?j.then((function(t){var e;return null===(e=I)||void 0===e||e.finish(),t})):(null===(h=I)||void 0===h||h.finish(),j)}var span=null===(l=O)||void 0===l?void 0:l.startChild(r(this,e,m.slice(0,-1)));return t.call.apply(t,Object(c.__spread)([this],m.slice(0,-1),[function(t,e){var n;null===(n=span)||void 0===n||n.finish(),v(t,e)}]))}}))}},t.prototype._getSpanContextFromOperationArguments=function(t,e,n){var data={collectionName:t.collectionName,dbName:t.dbName,namespace:t.namespace},r={op:"db",description:e,data:data},o=j[e],d=Array.isArray(this._describeOperations)?this._describeOperations.includes(e):this._describeOperations;if(!o||!d)return r;try{if("mapReduce"===e){var h=Object(c.__read)(n,2),map=h[0],l=h[1];data[o[0]]="string"==typeof map?map:map.name||"<anonymous>",data[o[1]]="string"==typeof l?l:l.name||"<anonymous>"}else for(var i=0;i<o.length;i++)data[o[i]]=JSON.stringify(n[i])}catch(t){}return r},t.id="Mongo",t}(),T=n(3123);Object(o.a)()},282:function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return l}));var r=n(4),o=n(191),c=n(190),d=n(67),h=function(){function t(t){void 0===t&&(t=1e3),this.spans=[],this._maxlen=t}return t.prototype.add=function(span){this.spans.length>this._maxlen?span.spanRecorder=void 0:this.spans.push(span)},t}(),l=function(){function t(t){if(this.traceId=Object(o.f)(),this.spanId=Object(o.f)().substring(16),this.startTimestamp=Object(c.d)(),this.tags={},this.data={},!t)return this;t.traceId&&(this.traceId=t.traceId),t.spanId&&(this.spanId=t.spanId),t.parentSpanId&&(this.parentSpanId=t.parentSpanId),"sampled"in t&&(this.sampled=t.sampled),t.op&&(this.op=t.op),t.description&&(this.description=t.description),t.data&&(this.data=t.data),t.tags&&(this.tags=t.tags),t.status&&(this.status=t.status),t.startTimestamp&&(this.startTimestamp=t.startTimestamp),t.endTimestamp&&(this.endTimestamp=t.endTimestamp)}return t.prototype.child=function(t){return this.startChild(t)},t.prototype.startChild=function(e){var n=new t(Object(r.__assign)(Object(r.__assign)({},e),{parentSpanId:this.spanId,sampled:this.sampled,traceId:this.traceId}));return n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n),n.transaction=this.transaction,n},t.prototype.setTag=function(t,e){var n;return this.tags=Object(r.__assign)(Object(r.__assign)({},this.tags),((n={})[t]=e,n)),this},t.prototype.setData=function(t,e){var n;return this.data=Object(r.__assign)(Object(r.__assign)({},this.data),((n={})[t]=e,n)),this},t.prototype.setStatus=function(t){return this.status=t,this},t.prototype.setHttpStatus=function(t){this.setTag("http.status_code",String(t));var e=function(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(t);return"unknown_error"!==e&&this.setStatus(e),this},t.prototype.isSuccess=function(){return"ok"===this.status},t.prototype.finish=function(t){this.endTimestamp="number"==typeof t?t:Object(c.d)()},t.prototype.toTraceparent=function(){var t="";return void 0!==this.sampled&&(t=this.sampled?"-1":"-0"),this.traceId+"-"+this.spanId+t},t.prototype.toContext=function(){return Object(d.c)({data:this.data,description:this.description,endTimestamp:this.endTimestamp,op:this.op,parentSpanId:this.parentSpanId,sampled:this.sampled,spanId:this.spanId,startTimestamp:this.startTimestamp,status:this.status,tags:this.tags,traceId:this.traceId})},t.prototype.updateWithContext=function(t){var e,n,r,o,c;return this.data=null!=(e=t.data)?e:{},this.description=t.description,this.endTimestamp=t.endTimestamp,this.op=t.op,this.parentSpanId=t.parentSpanId,this.sampled=t.sampled,this.spanId=null!=(n=t.spanId)?n:this.spanId,this.startTimestamp=null!=(r=t.startTimestamp)?r:this.startTimestamp,this.status=t.status,this.tags=null!=(o=t.tags)?o:{},this.traceId=null!=(c=t.traceId)?c:this.traceId,this},t.prototype.getTraceContext=function(){return Object(d.c)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,trace_id:this.traceId})},t.prototype.toJSON=function(){return Object(d.c)({data:Object.keys(this.data).length>0?this.data:void 0,description:this.description,op:this.op,parent_span_id:this.parentSpanId,span_id:this.spanId,start_timestamp:this.startTimestamp,status:this.status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this.endTimestamp,trace_id:this.traceId})},t}()},410:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(4),o=n(89),c=n(52),d=n(38),h=n(67),l=n(34),m=n(282),f=function(t){function e(e,n){var r=t.call(this,e)||this;return r._measurements={},r._hub=Object(o.b)(),Object(c.g)(n,o.a)&&(r._hub=n),r.name=e.name||"",r.metadata=e.metadata||{},r._trimEnd=e.trimEnd,r.transaction=r,r}return Object(r.__extends)(e,t),e.prototype.setName=function(t){this.name=t},e.prototype.initSpanRecorder=function(t){void 0===t&&(t=1e3),this.spanRecorder||(this.spanRecorder=new m.b(t)),this.spanRecorder.add(this)},e.prototype.setMeasurements=function(t){this._measurements=Object(r.__assign)({},t)},e.prototype.setMetadata=function(t){this.metadata=Object(r.__assign)(Object(r.__assign)({},this.metadata),t)},e.prototype.finish=function(e){var n=this;if(void 0===this.endTimestamp){if(this.name||(l.a&&d.c.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this.name="<unlabeled transaction>"),t.prototype.finish.call(this,e),!0===this.sampled){var r=this.spanRecorder?this.spanRecorder.spans.filter((function(s){return s!==n&&s.endTimestamp})):[];this._trimEnd&&r.length>0&&(this.endTimestamp=r.reduce((function(t,e){return t.endTimestamp&&e.endTimestamp?t.endTimestamp>e.endTimestamp?t:e:t})).endTimestamp);var o={contexts:{trace:this.getTraceContext()},spans:r,start_timestamp:this.startTimestamp,tags:this.tags,timestamp:this.endTimestamp,transaction:this.name,type:"transaction",sdkProcessingMetadata:this.metadata};return Object.keys(this._measurements).length>0&&(l.a&&d.c.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),o.measurements=this._measurements),l.a&&d.c.log("[Tracing] Finishing "+this.op+" transaction: "+this.name+"."),this._hub.captureEvent(o)}l.a&&d.c.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled.");var c=this._hub.getClient(),h=c&&c.getTransport&&c.getTransport();h&&h.recordLostEvent&&h.recordLostEvent("sample_rate","transaction")}},e.prototype.toContext=function(){var e=t.prototype.toContext.call(this);return Object(h.c)(Object(r.__assign)(Object(r.__assign)({},e),{name:this.name,trimEnd:this._trimEnd}))},e.prototype.updateWithContext=function(e){var n;return t.prototype.updateWithContext.call(this,e),this.name=null!=(n=e.name)?n:"",this._trimEnd=e.trimEnd,this},e}(m.a)},57:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return h}));var r=n(89);function o(t){var e=Object(r.b)().getClient(),n=t||e&&e.getOptions();return!!n&&("tracesSampleRate"in n||"tracesSampler"in n)}function c(t){var e=(t||Object(r.b)()).getScope();return e&&e.getTransaction()}function d(time){return time/1e3}function h(time){return 1e3*time}}}]);