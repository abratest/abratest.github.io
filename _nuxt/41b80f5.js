(window.webpackJsonp=window.webpackJsonp||[]).push([[473],{825:function(e,t,n){"use strict";n(32),n(24),n(25),n(22);var r=n(43),o=(n(68),n(15),n(12),n(166),n(10)),c=(n(165),n(0)),l=n(640),d=n(47),f=n(39),h=n(287),v=n(9);function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function w(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var y,line,x,k="001",S="002",O="003",R="004",X=[{width:1,height:1,size:96},{width:3,height:3,size:864},{width:6,height:6,size:3456},{width:12,height:12,size:13824},{width:24,height:24,size:55296}],Y={1:"Small",2:"Medium",3:"Large",4:"Extra Large"},E=null,I=[],j=[],L=null,P=null,M=[],A=!1,C=!0,D={},z=[],N={rows:[],count:0},W=null,J=null,_=null,H="#2AC161",F="#FF0044",T="#00B0FF",U="#ff8c00",B="#7C4BE5",G="#ff33e7",K="#FFE047",Q="#12161C",V="#F2F2F2",Z=document.createElement("canvas"),$=document.createElement("canvas"),ee=Z.getContext("2d",{alpha:!1}),te=$.getContext("2d",{alpha:!1}),ne=!1,re=[],ae={tsb:null,binance:null};function se(e){return ie.apply(this,arguments)}function ie(){return(ie=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.state.products.isFromSalemap){e.next=15;break}return e.prev=1,E&&(E.close(1e3,"reloading"),E=null),D={},C=!0,A=!0,t.dispatch("products/setLoading",!0),t.dispatch("products/setMapRetry",!1),e.next=10,oe(t);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),"Cannot open connection"===e.t0.message&&(A=!1,C=!0,D={},t.dispatch("products/setLoading",!0),t.dispatch("products/setMapRetry",!0),We(),x=setTimeout((function(){A||se(t).catch((function(){}))}),1e4));case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function oe(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(n,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(E=Object(l.a)("/ws/map")).addEventListener("close",(function(e){"reloading"===e.reason?n():r(new Error("Cannot open connection"))})),E.addEventListener("message",(function(e){var r=e.data;if(xe(r,O))return le({store:t,resolve:n});if(xe(r,R))t.dispatch("map/setProperty",{prop:"clients",value:be(r,R)});else{if(xe(r,k))return ve({data:be(r,k),store:t});if(xe(r,S))return we({data:be(r,S),store:t})}}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ue={limit:0};function le(e){return de.apply(this,arguments)}function de(){return(de=Object(c.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,r=t.resolve,e.next=3,n.dispatch("opensea/setup");case 3:return e.next=5,n.dispatch("opensea/getLandOrders",ue);case 5:return N=n.getters["opensea/get"]("landOrders",{rows:[],count:0}),o=n.getters["presaleconfig/getCurrentActivePresale"],_=o.sector,"0x7a9fe22691c811ea339d9b73150e6911a5343dca",e.next=11,d.a.getLandsAuctions({walletAddress:"0x7a9fe22691c811ea339d9b73150e6911a5343dca",auctionUrl:v.H});case 11:if(W=(W=e.sent).data,J=n.state.user.currentUser,P=J&&J.Wallets&&J.Wallets.length>0&&J.Wallets[0].address&&J.Wallets[0].address.toLowerCase(),c=n.getters["presaleconfig/getCurrentActivePresale"]){e.next=18;break}return e.abrupt("return",r());case 18:return e.next=20,pe(n,c);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e,t){return fe.apply(this,arguments)}function fe(){return(fe=Object(c.a)(regeneratorRuntime.mark((function e(t,n){var data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.a.getSector(n.sector).catch((function(e){if(e.response){if("Presale hasn't started yet"===e.response.data.error)return{lands:[],estates:[],sector:n.sector};throw e}}));case 2:return data=e.sent,e.next=5,he({data:data,store:t});case 5:D[n.sector]=!0,C&&(C=!1,t.dispatch("products/setLoading",!1));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return ge.apply(this,arguments)}function ge(){return(ge=Object(c.a)(regeneratorRuntime.mark((function e(t){var data,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:data=t.data,n=t.store,r=data.lands.map((function(e){return ke(e,data.sector)})),data.lands.forEach(Oe),data.estates.map((function(e){return Se(e,[],data.sector)})),n.dispatch("products/sectorUpdated"),n.dispatch("products/estateUpdated"),Le(r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ve(e){return me.apply(this,arguments)}function me(){return(me=Object(c.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=t.store,o=t.shouldDispatch,c=void 0===o||o,!C){e.next=3;break}return e.abrupt("return");case 3:n.forEach(ke),n.forEach(Oe),L&&c&&(l=n.find((function(e){return e.id===L.id})))&&r.dispatch("products/getLandSale",{id:l.id,data:l,map:!0}),Le(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e){return ye.apply(this,arguments)}function ye(){return(ye=Object(c.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=t.store,!C){e.next=3;break}return e.abrupt("return");case 3:o=[],n.forEach((function(e){return Se(e,o)})),r.dispatch("products/estateUpdated"),L&&(c=n.find((function(e){return e.id===L.id})))&&r.dispatch("products/getEstate",{id:c.id,data:c,map:!0}),Le(o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(data,e){return data.startsWith(e)}function be(data,e){return JSON.parse(function(data,e){return data.substring(e.length)}(data,e))}function ke(e,t){e.x=e.coordinateX||e.x,e.y=e.coordinateY||e.y;var n=JSON.parse(JSON.stringify(I[e.x]&&I[e.x][e.y]||{}));return void 0!==e.o&&delete n.ownerAddress,void 0!==e.s&&delete n.owned,void 0!==e.b&&delete n.bundleId,void 0!==e.e&&delete n.estate,Object.assign(e,n),e.sector=parseInt(e.sector||t),e.coordinateX=e.x,e.coordinateY=e.y,e.ownerAddress=e.o||e.ownerAddress,e.owned=Object(h.a)(e.s)||Object(h.a)(e.owned)||e.sector<_,e.bundleId=parseInt(e.b||e.bundleId),e.premium=!!e.bundleId||Object(h.a)(e.premium),e.estate=e.e||e.estate,e.available=!e.ownerAddress&&e.sector>_-1,e.typeName=e.premium?"Premium":"Land",e.dimensions=X[0],e.size=y,e.type=0,e.Lands=[{x:e.x,y:e.y}],e.sandbox=Me(e),e.binance=Ae(e),I[e.x]||(I[e.x]=[]),I[e.x][e.y]=e,delete e.o,delete e.s,delete e.p,delete e.e,e}function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;e.x=e.coordinateX||e.x,e.y=e.coordinateY||e.y,e.Lands&&e.Lands.length>0&&e.Lands.forEach((function(t){return ke(w(w({},t),{},{e:e.id,o:e.o||e.ownerAddress,s:!!t.blockchainId}),e.sector||n)}));var o=JSON.parse(JSON.stringify(j[e.x]&&j[e.x][e.y]||{}));void 0!==e.o&&delete o.ownerAddress,void 0!==e.t&&delete o.type,void 0!==e.l&&delete o.logoHash,void 0!==e.c&&delete o.isComplete,Object.assign(e,o);var c,l=M.findIndex((function(t){return t.id===e.id}));if(e.logoHash=e.l||e.logoHash,-1!==l){var d=M[l].logo;if(d&&d.img){var f=!(d.img===ae.tsb||d.img===ae.binance||d.logoHash===e.logoHash);d.logoHash===e.logoHash&&(c=d.img),f&&(d.img.height=0,d.img.width=0)}M[l]=e}else M.push(e);e.sector=parseInt(e.sector||n),e.coordinateX=e.x,e.coordinateY=e.y,e.ownerAddress=e.o||e.ownerAddress,e.type=e.t||e.type,e.isComplete=e.c||e.isComplete;var h=X[e.type].width*y;e.logo={img:c||ze(e,r),x:e.x*y+204*y+3*line,y:e.y*y+204*y+3*line,size:h-6*line,logoHash:e.logoHash},e.dimensions=X[e.type],e.available=!e.ownerAddress&&e.sector>_-1,e.typeName=Y[e.type],e.Lands=[];for(var v=e.x,m=e.y,x=X[e.type],i=v;i<v+x.width;i++)for(var k=m;k<m+x.width;k++){var S=I[i][k];S.available=e.available,t.push(S),e.Lands.push(S),j[i]||(j[i]=[]),j[i][k]=e}delete e.o,delete e.t,delete e.l,delete e.c}function Oe(e){var t=parseInt(e.coordinateX),n=parseInt(e.coordinateY);if(e.startX=t*e.size+line,e.startY=n*e.size+line,e.endX=e.size-2*line,e.endY=e.size-2*line,e.estate){var r=I[t][n+1],o=I[t+1]&&I[t+1][n];r=r&&r.estate==e.estate,(o=o&&o.estate==e.estate)&&(e.endX+=2*line),r&&(e.endY+=2*line)}return e.startMiniX=t*(e.size/y)+line/y,e.startMiniY=n*(e.size/y)+line/y,e.endMiniX=e.size/y-line/y,e.endMiniY=e.size/y-line/y,e}function Re(e,t,n,r){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(c.a)(regeneratorRuntime.mark((function e(t,n,o,c){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ne){e.next=4;break}return n||o||re.splice(0),re.push([t,n,o,c||L]),e.abrupt("return");case 4:return ne=!0,e.next=7,Ye(t,n,o,c||L);case 7:ne=!1,re.length>0&&Re.apply(void 0,Object(r.a)(re.shift()));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e,t){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(c.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,l,image,d,f,h,v,m=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=m.length>2&&void 0!==m[2]&&m[2],o=m.length>3?m[3]:void 0,c=ee,l=te,r||(image=z[0])&&(c.drawImage(image,0,0,408*y,408*y),l.drawImage(image,0,0,408,408)),d=function(e){return(o.Lands||[o]).some((function(t){return t.x===e.x&&t.y===e.y}))},e.t0=regeneratorRuntime.keys(t);case 7:if((e.t1=e.t0()).done){e.next=22;break}if(f=e.t1.value,I[f]){e.next=11;break}return e.abrupt("continue",7);case 11:e.t2=regeneratorRuntime.keys(t[f]);case 12:if((e.t3=e.t2()).done){e.next=20;break}if(h=e.t3.value,v=I[f][h]){e.next=17;break}return e.abrupt("continue",12);case 17:Pe(v,n&&d(v)),e.next=12;break;case 20:e.next=7;break;case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){var t=e&&e.ownerAddress;return t&&P&&t.toLowerCase()===P}function je(e){if(L){var t=L.Lands||[L];L=null,Le(t,!1)}e&&(L=e,Le(e.Lands||[e],!0))}function Le(e,t){for(var n=[],i=0;i<e.length;i++){var r=e[i];n[r.x]||(n[r.x]=[]),n[r.x][r.y]=r}Re(n,t,!0)}function Pe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=ee,r=te;n.fillStyle=U;var o=j[e.x]&&j[e.x][e.y];t?n.fillStyle=G:Ce(e)||De(e)||e.ops?n.fillStyle=V:e.sandbox?n.fillStyle=T:e.binance?n.fillStyle=Q:Ie(e)?n.fillStyle=F:e.available||e.owned||e.sandbox||o&&o.logo&&o.logo.img?!e.available||e.ownerAddress?n.fillStyle=H:e.premium&&(n.fillStyle=K):n.fillStyle=B,n.fillRect(e.startX+204*y,e.startY+204*y,e.endX,e.endY),r.fillStyle=n.fillStyle,t||r.clearRect(e.startMiniX+204,e.startMiniY+204,e.endMiniX,e.endMiniY),r.fillRect(e.startMiniX+204,e.startMiniY+204,e.endMiniX,e.endMiniY)}function Me(e){return function(e,t){return(e&&e.ownerAddress||"").toLowerCase()===t}(e,"0x7a9fe22691c811ea339d9b73150e6911a5343dca")}function Ae(e){return 1e3===parseInt(e.sector)}function Ce(e){return N.rows.filter((function(t){return t.x===e.x&&t.y===e.y})).length>0}function De(e){return W.filter((function(t){return e.x===t.x&&e.y===t.y})).length>0}function ze(e,t){if(void 0!==t)return function(e,t,n){var canvas=document.createElement("canvas"),r=canvas.getContext("2d",{alpha:!0});canvas.width=e*y*10,canvas.height=t*y*10,r.translate(0,canvas.height),r.scale(1,-1),r.fillStyle="white";var o=18*y;return r.font="".concat(o,"px Arial"),r.fillText(n,0,canvas.height),canvas}(X[e.type].width,X[e.type].height,t);if(e.isComplete){if(e.logoHash)return Ne(X[e.type].width,X[e.type].height,"".concat(Object(f.a)(!1),"/estates/").concat(e.id,"/logo?").concat(e.logoHash));if(Me(e))return ae.tsb||(ae.tsb=Ne(X[4].width,X[4].height,"/img/18_Land/logos/TSB_Estate_Logo.webp")),ae.tsb;if(Ae(e))return ae.binance||(ae.binance=Ne(X[4].width,X[4].height,"/img/18_Land/logos/Binance_Estate_Logo.webp")),ae.binance}}function Ne(e,t,n){var canvas=document.createElement("canvas"),r=canvas.getContext("2d",{alpha:!0});canvas.width=e*y*10,canvas.height=t*y*10,r.translate(0,canvas.height),r.scale(1,-1);var img=new Image(canvas.width,canvas.height);return img.onload=function(){r.fillStyle="#00000000",r.fillRect(0,0,canvas.width,canvas.height),r.drawImage(img,0,0,canvas.width,canvas.height)},img.src=n,canvas}function We(){x&&(clearTimeout(x),x=null)}t.a=function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.store,line=(y=10)/10,Z.style="display: none",Z.width=408*y,Z.height=408*y,$.style="display: none",$.width=408,$.height=408,r.watch((function(e){return e.presaleconfig.configs}),Object(c.a)(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.state.products.saleMapWS||C){e.next=5;break}if(t=r.getters["presaleconfig/get"]("configs")){e.next=4;break}return e.abrupt("return");case 4:t.filter((function(e){return!D[e.sector]})).forEach((function(e){var t=r.getters["presaleconfig/getCurrentActivePresale"];t&&t.sector===e.sector&&pe(r,e)}));case 5:case"end":return e.stop()}}),e)})))),r.watch((function(e){return e.products.saleMapWS}),function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(se(r),n="/img/00_General/metaverse.webp",image=void 0,(image=new Image).src=n,z.push(image),image.onload=function(){return Re(I)});case 1:case"end":return e.stop()}var n,image}),e)})));return function(t){return e.apply(this,arguments)}}()),r.watch((function(e){return e.products.mapRetry}),(function(e){A||e||(We(),se(r))})),r.watch((function(e){return e.user.currentUser}),(function(e){P=e&&e.Wallets&&e.Wallets.length>0&&e.Wallets[0].address&&e.Wallets[0].address.toLowerCase(),r.state.products.saleMapWS&&Re(I)})),L=r.state.products.mapSelected,r.watch((function(e){return e.products.mapSelected}),(function(e){r.state.products.saleMapWS?je(e):L=e})),n("offscreenSaleCanvas",(function(){return Z})),n("miniMapSaleCanvas",(function(){return $})),n("getLandSale",(function(e){var t=e.x,n=e.y;if(I[t]&&I[t][n]){var r=JSON.parse(JSON.stringify(I[t][n]));return r&&r.estate&&j[t]&&j[t][n]&&(r.Estate=JSON.parse(JSON.stringify(j[t][n]))),r}return null})),n("getEstatesSale",(function(){return M})),n("updateLandSale",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];ve({data:[JSON.parse(JSON.stringify(e))],store:r,shouldDispatch:t})})),n("updateEstateSale",(function(e){we({data:[JSON.parse(JSON.stringify(e))],store:r})}));case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},826:function(e,t,n){"use strict";var r,o,c,line,l=n(43),d=(n(12),n(58),n(122),n(15),n(0)),f=n(63),h=[],v=[],m=document.createElement("canvas"),w=m.getContext("2d",{alpha:!0}),y=document.createElement("canvas"),x=y.getContext("2d",{alpha:!0}),k=[],S=!1,O=!1,R=null,X="#00ADEF",Y="#454d63",E="#464e63",I="#2e364d",j="#222839",L="#202429",P="#363a47";function M(e){line=(c=e||40)/20*1.2,r=24*c,o=12*c,m.style="display: none",m.width=r,m.height=r,y.style="display: none",y.width=r,y.height=r}function A(e){return C.apply(this,arguments)}function C(){return(C=Object(d.a)(regeneratorRuntime.mark((function e(t){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.dispatch("products/setLoading",!0),h=[],e.next=4,t.dispatch("experiences/clearExperiences");case 4:return h.length=0,n=t.getters["season/get"]("currentSeason"),r=t.getters["season/get"]("nextSeason"),(S=!n&&!r)&&(o=t.getters["season/get"]("lastSeason")),n&&(O=!0),c=n&&n.id||r&&r.id||o&&o.id,e.next=13,t.dispatch("experiences/getExperiencesOpt",{seasonId:c,gating:!0,events:!0,progress:O||S});case 13:return l=t.getters["experiences/get"]("experiencesOpt").filter((function(e){return 2!==e.metaverse.access.lockstate})),z(w),e.next=17,D("/img/00_General/metaverse-playmap.webp");case 17:return l.forEach((function(e){return W(e)})),U(w),e.next=21,D("/img/00_General/metaverse-playmap.webp");case 21:R=null,t.dispatch("products/setLoading",!1);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return new Promise((function(t,n){var img=new Image;img.onload=function(){return function(img){var e=Math.min(m.width/img.width,m.height/img.height),t=m.width/2-img.width/2*e,n=m.height/2-img.height/2*e;w.drawImage(img,t,n,img.width*e,img.height*e)}(this),t(img.height)},img.onerror=n,img.src=e}))}function z(e){e.strokeStyle="#000",e.lineWidth=line,e.clearRect(0,0,r,r);for(var i=0;i<=24;i++)e.beginPath(),e.moveTo(i*c,0),e.lineTo(i*c,r),e.stroke(),e.beginPath(),e.moveTo(0,i*c),e.lineTo(r,i*c),e.stroke()}function N(e,t,n,r){var a=parseInt(e[r?"".concat(n):"coordinate".concat(n)]),b=parseInt(t[r?"".concat(n):"coordinate".concat(n)]);return a===b?0:a<b?-1:1}function W(e){var t=0,n=e.metaverse.access.lockstate,r=e.metaverse.access.locks,l=e.playerEvents,d=Array.from(e.metaverse.lands),m=e.achievements,w=e.expProgress,y=e.totalAchEP,x=[];d.sort((function(a,b){return N(a,b,"X")})),d.sort((function(a,b){return N(a,b,"Y")})),d.forEach((function(k){var S=parseInt(k.coordinateX)-1,O=parseInt(k.coordinateY)-1,R=o+S*c+line,X=o-O*c-c+line,Y=f.a.logoURL(e.id,e.versions[0].id),E={id:e.id,name:e.versions[0].friendlyName,version:e.versions[0],x:S,y:O,position:t,canvasX:R,canvasY:X,logo:Y,type:e.type,lockstate:n,playerEvents:l,sizeX:e.sizeX,sizeY:e.sizeY,parcels:d.length,owner:e.owner,locks:e.metaverse.access.locks,achievements:m,totalEP:y,expProgress:w,tags:e.tags,corners:{canvasX:o+(parseInt(d[0].coordinateX)-1)*c+line,canvasY:o-(parseInt(d[d.length-1].coordinateY)-1)*c-c+line},dimensions:J({x:d[0].coordinateX,y:d[0].coordinateY},{x:d[d.length-1].coordinateX,y:d[d.length-1].coordinateY}),land:{coordinateX:d[0].coordinateX,coordinateY:d[0].coordinateY}};1===n&&(E.locks=r),S>=-12&&S<=11&&O>=-12&&O<=11&&(h[S]||(h[S]=[]),h[S][O]=E,t++,1===n&&0===r[0].type&&x.push(E),v.push({coordinateX:S,coordinateY:O}))})),1===n&&0===r[0].type&&k.push(x);var S=_(d[0]),O=_(d[d.length-1]);if(S&&O){var R=J(S,O);H({id:e.id,canvasX:S.canvasX,canvasY:O.canvasY,width:R.width,height:R.height,logo:S.logo,lockstate:n,playerEvents:l,expProgress:w,achievements:m,publishDate:r&&r[0]&&r[0].timestamp,locks:r})}}function J(e,t){return{width:(Math.abs(e.x-t.x)+1)*c-2*line,height:(Math.abs(t.y-e.y)+1)*c-2*line}}function _(e){var t=parseInt(e.coordinateX)-1,n=parseInt(e.coordinateY)-1;return h[t]&&h[t][n]}function H(e){return F.apply(this,arguments)}function F(){return(F=Object(d.a)(regeneratorRuntime.mark((function e(t){var n,r,img,o,c,l,d,f,h,v,y,image,k,E,I,i,j,L,M,A,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=w,r=x,e.t0=t.lockstate,e.next=0===e.t0?5:1===e.t0?7:9;break;case 5:return n.fillStyle=S?P:X,e.abrupt("break",10);case 7:return n.fillStyle=P,e.abrupt("break",10);case 9:n.fillStyle=Y;case 10:if(n.fillRect(t.canvasX,t.canvasY,t.width,t.height),!t.logo){e.next=26;break}return e.next=14,T(t.logo);case 14:if(img=e.sent,(O||S)&&(c=(null===(o=t.achievements)||void 0===o?void 0:o.length)||0,l=t.expProgress&&t.expProgress.length,d=t.playerEvents&&t.playerEvents.exp_spawn,(l&&c&&l===c||!c&&d)&&(f=t.canvasX-7,h=t.canvasY-5,v=30,y=30,t.width<36&&(f=t.canvasX-6,h=t.canvasY-4,v=23,y=23),(image=new Image).onload=function(){n.drawImage(image,f,h,v,y),r.drawImage(image,f,h,v,y)},image.src="/img/26_Season/completed-background.svg")),n.save(),r.save(),(k=/^((?!chrome|android).)*safari/i.test(navigator.userAgent))||1!==t.lockstate&&!S||(n.filter="grayscale(1)",r.filter="grayscale(1)"),n.drawImage(img,t.canvasX,t.canvasY,t.width,t.height),r.drawImage(img,t.canvasX,t.canvasY,t.width,t.height),k&&(1===t.lockstate||S)){for(E=n.getImageData(t.canvasX,t.canvasY,t.width,t.height),I=E.data,i=0,j=I.length;i<j;i+=4)L=.3*I[i]+.59*I[i+1]+.11*I[i+2],I[i]=L,I[i+1]=L,I[i+2]=L;n.putImageData(E,t.canvasX,t.canvasY),r.putImageData(E,t.canvasX,t.canvasY)}(1===t.lockstate||S)&&(n.restore(),n.save(),n.fillStyle="rgba(0, 29, 115, 0.25)",n.fillRect(t.canvasX,t.canvasY,t.width,t.height),r.restore(),r.save(),r.fillStyle="rgba(0, 29, 115, 0.25)",r.fillRect(t.canvasX,t.canvasY,t.width,t.height)),n.restore(),r.restore();case 26:M=!1,t.publishDate&&new Date(t.publishDate)<=new Date&&(A=Math.abs(new Date(t.publishDate).getTime()-(new Date).getTime()),M=A/36e5<24),M&&(n.beginPath(),n.lineWidth=3,n.strokeStyle="#00a5f2",n.rect(t.canvasX+1,t.canvasY+.9,t.width-1.5,t.height-1.5),n.stroke(),r.drawImage(m,0,0),(C=new Image).onload=function(){n.drawImage(C,t.canvasX+t.width-21,t.canvasY+2),r.drawImage(C,t.canvasX+t.width-21,t.canvasY+2)},C.src="/img/26_Season/Alpha_3/new-tag.svg"),R&&R.id===t.id&&K(null,R);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return new Promise((function(t){var img=new Image(10*c,10*c);img.crossOrigin="Anonymous",img.onload=function(){t(img)},img.src=e}))}function U(e){for(var t=c-2*line,n=c-2*line,r=0,l=0,d=0,f=0,m=function(m){for(var w=function(w){if((!h[m]||!h[m][w]||2===h[m][w].lockstate)&&m>=-12&&m<=11&&w>=-12&&w<=11&&(v.forEach((function(e,t){var n=e.coordinateX,r=e.coordinateY;0!==t?(f=Math.sqrt(Math.pow(m-n,2)+Math.pow(w-r,2)))<d&&(d=f):d=Math.sqrt(Math.pow(m-n,2)+Math.pow(w-r,2))})),d<=3.2&&(d=Math.round(d)),d<=3.2)){switch(d){case 1:e.fillStyle=E;break;case 2:e.fillStyle=I;break;case 3:e.fillStyle=j;break;default:e.fillStyle=L}r=o+m*c+line,l=o-w*c-c+line,e.fillRect(r,l,t,n)}},y=-24;y<=24;y++)w(y)},w=-24;w<=24;w++)m(w)}function B(e,t){return G.apply(this,arguments)}function G(){return(G=Object(d.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,l,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=k.filter((function(e){if(e[0]&&e[0].id===t)return e})))[0]){e.next=10;break}return e.next=4,n.dispatch("gating/experienceLock",t);case 4:o=n.getters["gating/get"]("experienceLock"),c=n.getters["season/get"]("userAccess"),r[0].forEach((function(e){o&&o[0]&&!o[0].tokenId?e.lockstate=0:e.lockstate=c&&c.access&&c.access.lockState,h[e.x][e.y]=e,v.push({coordinateX:e.x,coordinateY:e.y})})),l=r[0][0],d=r[0][r[0].length-1],l&&d&&(f=J(l,d),w.drawImage(y,0,0),H({id:l.id,canvasX:l.canvasX,canvasY:d.canvasY,width:f.width,height:f.height,logo:l.logo,lockstate:l.lockstate,playerEvents:l.playerEvents,expProgress:l.expProgress,achievements:l.achievements,publishDate:l.locks&&l.locks[0]&&l.locks[0].timestamp}),x.drawImage(m,0,0));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(d.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R=n,r=w,t&&r.drawImage(y,0,0),n&&(r.beginPath(),r.lineWidth=2,r.strokeStyle="white",r.rect(n.corners.canvasX+1,n.corners.canvasY+.9,n.dimensions.width-1.5,n.dimensions.height-1.5),r.stroke());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){var t;e.forEach((function(e){h[e.coordinateX-1]&&((t=h[e.coordinateX-1][e.coordinateY-1]).expProgress=e.expProgress,t.playerEvents=e.playerEvents,h[e.coordinateX-1][e.coordinateY-1]=t)}));var n=Object(l.a)(e),r=_((n=(n=n.sort((function(a,b){return N(a,b,"X")}))).sort((function(a,b){return N(a,b,"Y")})))[0]),o=_(n[n.length-1]);if(r&&o){var c=J(r,o);w.drawImage(y,0,0),H({id:r.id,canvasX:r.canvasX,canvasY:o.canvasY,width:c.width,height:c.height,logo:r.logo,lockstate:r.lockstate,playerEvents:r.playerEvents,expProgress:r.expProgress,achievements:r.achievements,publishDate:r.locks&&r.locks[0]&&r.locks[0].timestamp}),x.drawImage(m,0,0)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.store,n("offscreenPlayCanvas",(function(){return m})),n("playCanvasSize",(function(){return c})),n("gridSize",(function(){return 24})),n("setScale",M),n("loadNewExperience",(function(e){return B(e,r)})),n("selectExperience",(function(e,t){return K(e,t,r)})),n("refreshPlayerEvent",(function(e){return V(e)})),n("loadPlayMap",(function(){return A(r)})),n("getExperience",(function(e){var t=e.x,n=e.y;return h[t]?h[t][n]:null}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},840:function(e,t,n){"use strict";n(12);var r=n(0);function o(e,t){return c.apply(this,arguments)}function c(){return(c=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r,o,c,l,d,f,h,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.getters["user/getUser"],o=t.getters["season/get"]("currentSeason"),c=t.getters["season/get"]("lastSeason"),l=t.getters["referrals/getLink"]("en"),!r){e.next=11;break}return d=o?o.id:c&&c.id,f=o?o.startDate:null==c?void 0:c.startDate,h=o?o.endDate:null==c?void 0:c.endDate,v={username:r.username,seasonId:d,isTest:n,referralLink:l,from:f,to:h},e.next=11,t.dispatch("contest/connectUser",v);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.a=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.store,n("connectOperaEvents",(function(e){return o(r,e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}}]);